{"version":3,"sources":["src/achievement/index.js","src/achievement/manager.js","src/animation.js","src/audio/index.js","src/audio/manager.js","src/checkpoints.js","src/component/index.js","src/component/manager.js","src/constants.js","src/core/clamp.js","src/core/deleteitem.js","src/core/fisheryates.js","src/core/fullscreen.js","src/core/hbs.js","src/core/jqueryify.js","src/core/nexttick.js","src/core/objectify.js","src/core/options.js","src/core/path.js","src/core/random.js","src/core/root.js","src/game.js","src/gameobject.js","src/language.js","src/layer.js","src/localization/group.js","src/localization/index.js","src/log.js","src/mixin/language.js","src/mixin/templatable.js","src/prefab/index.js","src/prefab/manager.js","src/preloader.js","src/resource.js","src/scene/director.js","src/scene/index.js","src/serialize.js","src/sprite/index.js","src/sprite/manager.js","src/sprite/renderer/index.js","src/template/connector.js","src/template/engine.js","src/template/methods.js","src/template/string.js","src/tween.js","src/video.js","src/viewport.js","src/world/data.js","src/world/index.js","generated/templates.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxCA;AACA;AACA;AACA;AACA;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjeA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnBA;AACA;AACA;AACA;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjDA;AACA;AACA;AACA;AACA;AACA;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"dist/js/lyria.js","sourcesContent":["define('lyria/achievement', ['clamp'], function(clamp) {\r\n  'use strict';\r\n\r\n  var Achievement = (function() {\r\n    var Achievement = function(options) {\r\n      if (options == null) {\r\n        throw new Error('An achievement constructor needs to be called with a parameter');\r\n      }\r\n      \r\n      if (typeof options === 'string') {\r\n        options = {\r\n          name: options\r\n        };\r\n      }\r\n      \r\n      if (!options.name) {\r\n        // Break if no name has been specified\r\n        throw new Error('An achievement needs to have a name.');\r\n      } else {\r\n        this.name = options.name;\r\n      }\r\n\r\n      this.id = options.id || 'achievement-' + Date.now();\r\n      this.icon = options.icon || null;\r\n      \r\n      this.progress = options.progress || {min: 0, max: 1};\r\n\r\n      this.unlocked = (options.unlocked == null) ? false : options.unlocked;\r\n      \r\n      var progressCurrent = this.progress.min;\r\n\r\n      var self = this;\r\n\r\n      Object.defineProperty(this.progress, 'current', {\r\n        get: function() {\r\n          return progressCurrent;\r\n        },\r\n        set: function(value) {\r\n          progressCurrent = clamp(value, self.progress.min, self.progress.max);\r\n          \r\n          if (progressCurrent >= self.progress.max) {\r\n            self.unlocked = true;\r\n          } else {\r\n            if (self.unlocked === true) {\r\n              self.unlocked = false;\r\n            }\r\n          }\r\n        },\r\n        enumarable: true,\r\n        configurable: true\r\n      });\r\n    };\r\n\r\n    Achievement.prototype.reset = function() {\r\n      this.progress.current = this.progress.min;\r\n    };\r\n\r\n    Achievement.prototype.unlock = function() {\r\n      this.progress.current = this.progress.max;\r\n    };\r\n\r\n    Achievement.prototype.toJSON = function() {\r\n      var achObject = {};\r\n\r\n      for (var key in this) {\r\n        if (Object.hasOwnProperty.call(this, key)) {\r\n          continue;\r\n        }\r\n\r\n        achObject[key] = this[key];\r\n      }\r\n\r\n      return achObject;\r\n    };\r\n\r\n    Achievement.prototype.toString = function() {\r\n      return JSON.stringify(this.toJSON());\r\n    };\r\n\r\n    return Achievement;\r\n  })();\r\n\r\n  return Achievement;\r\n\r\n});\r\n","define('lyria/achievement/manager', ['require'], function(require) {\r\n  'use strict';\r\n\r\n  var $ = require('jquery');\r\n  var Achievement = require('../achievement');\r\n  var TemplateEngine = require('../template/engine');\r\n  var templateList = require('../template/list');\r\n  var Localization = require('../localization');\r\n\r\n  var achievementStore = {};\r\n\r\n  var AchievementManager = {\r\n    localization: new Localization(),\r\n    add: function(achievement) {\r\n      if ( achievement instanceof Achievement) {\r\n        if (!Object.hasOwnProperty.call(achievementStore, achievement.name)) {\r\n          achievementStore[achievement.name] = achievement;\r\n        }\r\n      }\r\n    },\r\n    progressSeparator: '/',\r\n    viewport: null,\r\n    remove: function(achName) {\r\n      if (Object.hasOwnProperty.call(achievementStore, achName)) {\r\n        delete achievementStore[achName];\r\n      }\r\n    },\r\n    list: function() {\r\n      //TemplateEngine.compile()\r\n    },\r\n    show: function(achName) {\r\n      var currentAchievement = achievementStore[achName];\r\n\r\n      if (currentAchievement == null) {\r\n        throw new Error('Achievement ' + achName + ' not found.');\r\n      }\r\n\r\n      var title = (AchievementManager.localization.exists(currentAchievement.name)) ? AchievementManager.localization.t(currentAchievement.name) : currentAchievement.name;\r\n      var description = (AchievementManager.localization.exists(currentAchievement.name + '-description')) ? AchievementManager.localization.t(currentAchievement.name + '-description') : currentAchievement.description;\r\n\r\n      var achTemplate = TemplateEngine.compile(templateList['achievement'])({\r\n        id: currentAchievement.id,\r\n        className: currentAchievement.name,\r\n        title: title,\r\n        description: description,\r\n        offscreen: true,\r\n        progressable: (currentAchievement.progress.max > 0 && currentAchievement.progress.max !== 1),\r\n        max: currentAchievement.progress.max,\r\n        current: currentAchievement.progress.current,\r\n        separator: AchievementManager.progressSeparator\r\n      });\r\n\r\n\r\n      if (AchievementManager.viewport == null) {\r\n        $('body').append(achTemplate);\r\n      } else {\r\n        AchievementManager.viewport.$element.append(achTemplate);\r\n      }\r\n\r\n      var $currentAchievement = $('#' + currentAchievement.id);\r\n\r\n      // Refactor this if lyria/tween is available\r\n      $currentAchievement.css({\r\n        opacity: 0.0\r\n      });\r\n      $currentAchievement.animate({\r\n        opacity: 1.0\r\n      }, 600).delay(2000).animate({\r\n        opacity: 0.0\r\n      }, 600, function() {\r\n        $currentAchievement.remove();\r\n      });\r\n    },\r\n    toJSON: function() {\r\n      var key, value;\r\n      var result = {};\r\n\r\n      for (key in achievementStore) {\r\n        value = achievementStore[key];\r\n        result[key] = value.toJSON();\r\n      }\r\n\r\n      return result;\r\n    },\r\n    toString: function() {\r\n      var result = '';\r\n\r\n      try {\r\n        result = JSON.stringify(AchievementManager.toJSON());\r\n      } catch (e) {\r\n        throw new Error('Error while serializing achievements in AchievementManager: ' + e);\r\n      }\r\n      return result;\r\n    },\r\n    fromJSON: function(achievements) {\r\n      var key, value;\r\n\r\n      for (key in achievements) {\r\n        value = achievements[key];\r\n        AchievementManager.add(value);\r\n      }\r\n    },\r\n    fromString: function(achievements) {\r\n      var deserializedValue = {};\r\n\r\n      try {\r\n        deserializedValue = JSON.parse(achievements);\r\n      } catch (e) {\r\n        throw new Error('Error while deserializing achivements in AchievementManager: ' + e);\r\n      }\r\n\r\n      return AchievementManager.fromJSON(deserializedValue);\r\n    }\r\n  };\r\n\r\n  Object.defineProperty(AchievementManager, 'length', {\r\n    get: function() {\r\n      return Object.keys(achievementStore).length;\r\n    }\r\n  });\r\n\r\n  Object.defineProperty(AchievementManager, 'unlockedCount', {\r\n    get: function() {\r\n      var counter = 0;\r\n\r\n      $.each(achievementStore, function(key, value) {\r\n        if (value.unlocked) {\r\n          counter++;\r\n        }\r\n      });\r\n\r\n      return counter;\r\n    }\r\n  });\r\n  \r\n  Object.defineProperty(AchievementManager, 'store', {\r\n    get: function() {\r\n      return achievementStore;\r\n    }\r\n  });\r\n\r\n  return AchievementManager;\r\n\r\n});\r\n","define('lyria/animation', ['jquery', 'mixedice', 'eventmap'], function($, mixedice, EventMap) {\n  'use strict';\n  \n  /**\n   * @module lyria/animation\n   * @requires jquery\n   * @requires mixedice\n   * @requires eventmap \n   */\n  \n  var Animation = (function() {\n    \n    /**\n     * @class\n     * @alias module:lyria/animation\n     * \n     * \n     * @param {Object} $elem\n     * @param {Object} options\n     * \n     * @fires play\n     * @fires pause\n     * @fires reset\n     * @fires stop\n     */\n    var Animation = function($elem, options) {\n      this.$elem = $elem;\n      \n      var defaultOptions = {\n        frame: {\n          width: 0,\n          height: 0,\n          current: 0\n        },\n        speed: 1\n      };\n      \n      options = $.extend(true, defaultOptions, options);\n      \n      this.frame = {};\n      this.frame.width = options.frame.width;\n      this.frame.height = options.frame.height;\n      this.frame.current = options.frame.current;\n      this.speed = options.speed;\n      \n      this.sprite = {};\n      this.sprite.width;\n      this.sprite.height;\n      this.sprite.image = new Image();\n      \n      // Mix-in eventmap\n      mixedice([this, Animation.prototype], new EventMap());\n      \n      this.on('play', function() {\n        \n      });\n      \n      this.on('pause', function() {\n        \n      });\n      \n      this.on('reset', function() {\n        \n      });\n      \n      this.on('stop', function() {\n        \n      });\n    };\n    \n    return Animation;\n  })();\n  \n  return Animation;\n});\n","define('lyria/audio', ['root', 'jquery'], function(root, $) {'use strict';\n\n  /**\n   * @module lyria/audio\n   * @requires root\n   * @requires jquery \n   */\n\n  var supportedTypes = {\n    'mp3' : 'audio/mpeg',\n    'wav' : 'audio/wav',\n    'ogg' : 'audio/ogg'\n  };\n\n  /**\n   * Create a new html audio object managed by lyria\n   *\n   * @class\n   * @alias module:lyria/audio\n   *\n   * @param {Object} options\n   * @param {String} options.id - unique identifier for this audio file\n   * @param {String[]} options.paths -  paths with different file types of the same audio file (fallback if browser doesnt support one)\n   * @param {Number} options.volume - volume between 0..1\n   * @param {Number} options.loop - -1 if unlimited, else 0 if no looping and a positive number for n loops\n   */\n  var Audio = function(options) {\n    options = $.extend({\n      'id' : '',\n      'volume' : 1.0,\n      'loop' : 1,\n      'paths' : []\n    }, options);\n    this.options = options;\n    this.audio = new window.Audio();\n    for (var i = 0; i < options.paths.length; i++) {\n      var fileExtension = options.paths[i].split('.').pop();\n\n      if (supportedTypes[fileExtension] && this.audio.canPlayType(supportedTypes[fileExtension])) {\n        this.audio.type = supportedTypes[fileExtension];\n        this.audio.src = options.paths[i];\n        break;\n      }\n    }\n    this.audio.volume = options.volume;\n    this.audio.id = 'lyria-audio-'+options.id;\n    // Preloading is set to false, as this is handled by lyria/preloader\n    this.audio.preload = 'none';\n    $('body').append(this.audio);\n  };\n\n  /**\n   *\n   * @param {Number} loop - amount of loops this song should be played (-1 if unlimited)\n   */\n  Audio.prototype.play = function(loop) {\n    // reset currentTime to 0 if already played\n    if (this.audio.currentTime) {\n      this.audio.currentTime = 0;\n    }\n    // reload audio file on chrome to be able to play an audio file more than once\n    if (detectr.is('browser-chrome')) {\n      this.audio.load();\n    }\n    if (loop != null) {\n      this.options.loop = loop;\n    }\n    if (this.options.loop && this.options.loop > 0) {\n      this.options.loop--;\n    }\n    this.audio.play();\n  };\n\n  Audio.prototype.pause = function() {\n    this.audio.pause();\n  };\n\n  /**\n   * Stop audio\n   */\n  Audio.prototype.stop = function() {\n    this.options.loop = 1;\n    this.audio.pause();\n    // reset currentTime if it was already set\n    if (this.audio.currentTime) {\n      this.audio.currentTime = 0;\n    }\n  };\n\n  /**\n   * Sets or gets properties of the audio object\n   *\n   * @param {String} prop -  property to set or get\n   * @param {*} [value] -  set value if passed\n   */\n  Audio.prototype.attr = function(prop, value) {\n    switch (prop) {\n      case 'duration':\n      case 'length':\n        return this.audio.duration;\n      case 'position':\n      case 'pos':\n        if ( typeof value === 'undefined') {\n          return this.audio.currentTime;\n        } else {\n          this.audio.currentTime = value;\n        }\n        break;\n      case 'loop':\n        if ( typeof value === 'undefined') {\n          return this.options.loop;\n        } else {\n          this.options.loop = value;\n        }\n        break;\n      case 'volume':\n      case 'vol':\n        if ( typeof value === 'undefined') {\n          return this.audio.volume;\n        } else {\n          this.audio.volume = value;\n        }\n        break;\n    }\n  };\n\n  return Audio;\n});\n","define('lyria/audio/manager', ['jquery', 'clamp', '../log', '../audio', 'mixedice', 'eventmap'], function($, clamp, Log, Audio, mixedice, EventMap) {\n  'use strict';\n\n  var AudioManager = function() {\n\n    mixedice([this, AudioManager.prototype], new EventMap());\n    this.audioFiles = {};\n  };\n\n  var volume = 1;\n  // default\n\n  Object.defineProperty(AudioManager, 'volume', {\n    get : function() {\n      return volume;\n    },\n    set : function(value) {\n      volume = clamp(value, 0, 1);\n    }\n  });\n\n  /**\n   * Add a new sound file to be manager by lyria\n   * @param {Object} options\n   * @param {String} options.type - ['music', 'sound']\n   * @param {String} options id - unique identifier for this audio file\n   * @param {Boolean} options.loop - -1 if unlimited, else 0 if no looping and a positive number for n loops\n   * @param {Number} options.volume - volume between 0..1\n   * @param {Array} options.paths - paths to audio file with defined fallbacks\n   *\n   */\n  AudioManager.prototype.add = function(options) {\n    options = $.extend({\n      'id' : '',\n      'type' : 'sound',\n      'loop' : false,\n      'volume' : 1.0,\n      'paths' : []\n    }, options);\n\n    // set volume in relation to current max volume\n    options.volume *= volume;\n\n    if (options.id === '') {\n      Log.e('AudioManager.add: No id was given for new audio object');\n      return;\n    }\n\n    this.audioFiles[options.id] = new Audio(options);\n    this.trigger('added', options.id, this.audioFiles[options.id]);\n    return this.audioFiles[options];\n  };\n\n  AudioManager.prototype.play = function(id, loop) {\n    if (!this.audioFiles[id]) {\n      Log.e('AudioManager.play: No audio element found under id ' + id);\n      return;\n    }\n    \n    $('#lyria-audio-' + id).off('ended');\n    $('#lyria-audio-' + id).on('ended', {\n      'audioFile' : this.audioFiles[id],\n      'audioManager' : this,\n      'id' : id\n    }, function(event) {\n      if (event.data.audioFile.attr('loop') > 0 || event.data.audioFile.attr('loop') === -1) {\n        event.data.audioFile.play();\n        event.data.audioManager.trigger('loopEnded', event.data.id, event.data.audioFile);\n      } else {\n        event.data.audioManager.trigger('ended', event.data.id, event.data.audioFile);\n      }\n    });\n    \n    this.audioFiles[id].play(loop);\n    this.trigger('play', id, this.audioFiles[id]);\n  };\n\n  AudioManager.prototype.pause = function(id) {\n    if (!this.audioFiles[id]) {\n      Log.e('AudioManager.pause: No audio element found under id ' + id);\n      return;\n    }\n    this.audioFiles[id].pause();\n    this.trigger('paused', id, this.audioFiles[id]);\n  };\n\n  AudioManager.prototype.stop = function(id) {\n    if (!this.audioFiles[id]) {\n      Log.e('AudioManager.stop: No audio element found under id ' + id);\n      return;\n    }\n    this.audioFiles[id].stop();\n    // ended event should be triggered automatically\n  };\n\n  AudioManager.prototype.volume = function(id, volume) {\n    if (!this.audioFiles[id]) {\n      Log.e('AudioManager.volume: No audio element found under id ' + id);\n      return;\n    }\n    if (volume) {\n      this.audioFiles[id].volume = clamp(volume, 0, 1);\n    } else {\n      return this.audioFiles[id].volume;\n    }\n  };\n  return AudioManager;\n});\n","define('lyria/checkpoints', ['eventmap', 'mixedice', 'deleteitem', 'performance'], function(EventMap, mixedice, deleteItem, performance) {\n  'use strict';\n\n  /**\n   * @module lyria/checkpoints\n   * @requires eventmap\n   * @requires mixedice\n   * @requires deleteitem\n   * @requires performance \n   */\n\n  return (function() {\n    \n    /**\n     * Checkpoints\n     *\n     * @class\n     * @alias module:lyria/checkpoints\n     */\n    var Checkpoints = function() {\n      // Mix-in eventmap\n      mixedice([this, Checkpoints.prototype], new EventMap());\n\n      // Set start time\n      this.startTime = performance.now();\n      \n      // List of all passed checkpoints\n      this.checkpointList = [];\n    };\n\n    /**\n     * Pass a checkpoint\n     * \n     * @param {String} name\n     */\n    Checkpoints.prototype.pass = function(name) {\n      // A checkpoint can only be passed once\n      if (this.hasPassed(name)) {\n        return;\n      }\n      \n      this.checkpointList.push(name);\n      \n      this.trigger('pass', name, (performance.now() - this.startTime));\n    };\n\n    /**\n     * Checks if a checkpoint has been passed\n     * \n     * @param {String} name\n     */\n    Checkpoints.prototype.hasPassed = function(name) {\n      return (this.checkpointList.indexOf(name) !== -1);\n    };\n\n    /**\n     * Reset a single or all checkpoints\n     * \n     * @param {String} name\n     */\n    Checkpoints.prototype.reset = function(name) {\n      if (this.checkpointList.length === 0) {\n        return;\n      }\n      \n      if (name == null) {\n        var oldList = this.checkpointList;\n        this.checkpointList = [];\n        this.trigger('reset', oldList);\n        return;\n      }\n      \n      var index = this.checkpointList.indexOf(name);\n\n      if (index === -1) {\n        return;\n      }\n\n      this.checkpointList = deleteItem(this.checkpointList, index);\n      this.trigger('reset', name);\n    };\n\n    return Checkpoints;\n  })();\n  \n});\n","define('lyria/component', ['mixedice', 'eventmap', './component/manager', './log'], function(mixedice, EventMap, ComponentManager, Log) {\r\n  'use strict';\r\n  \r\n  /**\r\n   * @module lyria/component\r\n   * @requires eventmap\r\n   * @requires lyria/component/manager\r\n   * @requires lyria/log \r\n   */\r\n\r\n  return (function() {\r\n    \r\n    /**\r\n     * @class\r\n     * @alias module:lyria/component\r\n     * @lends module:eventmap \r\n     */\r\n\r\n    var Component = function(name, factory) {\r\n      mixedice([this, Component.prototype], new EventMap());\r\n      \r\n      this.name = name != null ? name : this.constructor.name;\r\n      \r\n      this.type = 'Component';\r\n      \r\n      this.children = {};\r\n      \r\n      if (factory) {\r\n        factory.apply(this, [this]);        \r\n      }\r\n      \r\n      this.on('update', function(dt) {\r\n        for (var key in this.children) {\r\n          var value = this.children[key];\r\n          if (value && value.trigger) {\r\n            value.trigger('update', dt);\r\n          }\r\n        }\r\n      });\r\n    };\r\n    \r\n    /**\r\n     * Adds a component to this entity\r\n     * \r\n     * @param {Object} child\r\n     */\r\n    Component.prototype.add = function(child) {\r\n      var name = 'anonymous-' + Date.now();\r\n      var childObject = null;\r\n      \r\n      if (typeof child === 'string') {\r\n        name = child;\r\n        childObject = ComponentManager.get(name);\r\n      } else {\r\n        name = child.name || name;\r\n        childObject = child;\r\n      }\r\n      \r\n      this.children[name] = childObject;\r\n      \r\n      this.trigger('add', name);\r\n      childObject.trigger('added', this);\r\n    };\r\n    \r\n    /**\r\n     * Removes a component from the entity\r\n     *  \r\n     * @param {String} name\r\n     */\r\n    Component.prototype.remove = function(name) {\r\n      if (name == null) {\r\n        return;\r\n      }\r\n      \r\n      delete this.children[name];\r\n      \r\n      this.trigger('remove', name);\r\n    };\r\n    \r\n    /**\r\n     * Logs from the component itself\r\n     * \r\n     * @param {String} text\r\n     */\r\n    Component.prototype.log = function(text) {\r\n      if (this.type === this.name) {\r\n        Log.i(this.type + ': ' + text);                \r\n      } else {\r\n        Log.i('[' + this.type + '] ' + this.name + ': ' + text);        \r\n      }\r\n    };\r\n\r\n    return Component;\r\n\r\n  })();\r\n\r\n});\r\n","define('lyria/component/manager', function() {\n  'use strict';\n  \n  /**\n   * exports module/component/manager \n   */\n\n  var components = {};\n\n  var ComponentManager = {};\n\n  ComponentManager.add = function(component) {\n    var name = component.name || 'anonymous-' + Date.now();\n\n    components[name] = component;\n  };\n\n  ComponentManager.remove = function(name) {\n    if (name == null) {\n      return;\n    }\n    \n    delete ComponentManager[name];\n  };\n  \n  ComponentManager.get = function(name) {\n    return components[name];\n  };\n\n  return ComponentManager;\n\n});\n","// General constants\r\ndefine('lyria/constants', function() {\r\n  'use strict';\r\n  \r\n  /**\r\n   * @exports lyria/constants \r\n   */\r\n  \r\n  return {\r\n    animSpeed: 300\r\n  };\r\n}); ","define('clamp', function() {\n  'use strict';\n  \n  var clamp = function(value, min, max) {\n    var _ref, _ref1, _ref2;\n    if ( typeof value === 'object') {\n      _ref = value, min = _ref.min, max = _ref.max, value = _ref.value;\n    }\n    if (Array.isArray(min)) {\n      _ref1 = min, min = _ref1[0], max = _ref1[1];\n    }\n    if (min == null) {\n      min = 0.0;\n    }\n    if (max == null) {\n      max = 1.0;\n    }\n    if (min > max) {\n      _ref2 = [max, min], min = _ref2[0], max = _ref2[1];\n    }\n    if ((min <= value && value <= max)) {\n      return value;\n    } else {\n      if (value > max) {\n        return max;\n      } else {\n        return min;\n      }\n    }\n  };\n\n  return clamp;\n});\n","define('deleteitem', function() {\n  'use strict';\n  \n  var deleteItem = function(obj, item) {\n    var i, key, newObject, num, _i, _len, _results;\n    if (Array.isArray(obj)) {\n      _results = [];\n      for ( num = _i = 0, _len = obj.length; _i < _len; num = ++_i) {\n        i = obj[num];\n        if (num !== item) {\n          _results.push(i);\n        }\n      }\n      return _results;\n    } else {\n      newObject = {};\n      for (key in obj) {\n        if (key !== item) {\n          newObject[key] = obj[key];\n        }\n      }\n      return newObject;\n    }\n  };\n\n  return deleteItem;\n});\n","define('fisheryates', ['random'], function(random) {\n  'use strict';\n  \n  /**\n   * Randomize array element order in-place.\n   * Using Fisher-Yates shuffle algorithm.\n   */\n  return function(array) {\n    for (var i = array.length - 1; i > 0; i--) {\n      var j = random(i + 1);\n      var temp = array[i];\n      array[i] = array[j];\n      array[j] = temp;\n    }\n    return array;\n  };\n});\n","(function() {'use strict';\n\n  define('requestfullscreen', function() {\n    return function(element) {\n      if (element.requestFullScreen) {\n        element.requestFullScreen();\n      } else if (element.mozRequestFullScreen) {\n        element.mozRequestFullScreen();\n      } else if (element.webkitRequestFullScreen) {\n        element.webkitRequestFullScreen();\n      }\n    };\n  });\n\n  define('fullscreenelement', function() {\n    return function(element) {\n      return (element.fullscreenElement || element.mozFullScreenElement || element.webkitFullscreenElement);\n    };\n  });\n\n  define('cancelfullscreen', function() {\n    return function(element) {\n      if (element.cancelFullScreen) {\n        element.cancelFullScreen();\n      } else if (element.mozCancelFullScreen) {\n        element.mozCancelFullScreen();\n      } else if (element.webkitCancelFullScreen) {\n        element.webkitCancelFullScreen();\n      }\n    };\n  });\n\n  define('fullscreen', ['requestfullscreen', 'fullscreenelement', 'cancelfullscreen'], function(rf, fs, cf) {\n    return {\n      request: rf,\n      isFullscreen: fs,\n      cancel: cf\n    };\n  });\n  \n})(); ","define('hbs', ['handlebars', 'handlebars.runtime'], function(hbs, hbsRuntime) {\n  'use strict';\n  \n  return ((hbs && hbs['default']) || hbsRuntime);\n});","define('jqueryify', ['jquery'], function($) {\n  'use strict';\n  \n  return function(sel) {\n    return (sel instanceof $) ? sel : $(sel);\n  };\n});","/**\n * Trying to find a better alternative than setTimeout(fn, 0)\n * requestAnimationFrame should be a better alternative\n * TODO: Evaluate setImmediate shims\n */\ndefine('nexttick', ['requestanimationframe', 'cancelanimationframe'], function(requestAnimationFrame, cancelAnimationFrame) {\n  'use strict';\n  \n  return function(fn) {\n    var id = requestAnimationFrame(function() {\n      if (fn != null) {\n        fn();\n      }\n      cancelAnimationFrame(id);\n    });\n  };\n});\n","define('objectify', function() {\n  'use strict';\n  \n  return function(arr) {\n    if (typeof arr === 'object') {\n      if (!Array.isArray(arr)) {\n        return arr;\n      }\n    } else {\n      return {};\n    }\n\n    var rv = {};\n    for (var i = 0, j = arr.length; i < j; i++) {\n      if (arr[i] != null) {\n        rv[i] = arr[i];\n      }\n    }\n    return rv;\n  };\n});\n","define('options', ['jquery'], function($) {\n  'use strict';\n  \n  return function(obj, defaultOptions) {\n    return $.extend(true, obj, defaultOptions);\n  };\n});\n","define('path', function() {\n  'use strict';\n  \n  var delimiter = '/';\n\n  var Path = {\n    join: function(arr) {\n      var pathArray = (function() {\n        var result = [];\n\n        for (var i = 0, j = arr.length; i < j; i++) {\n          if (arr[i] != null && arr[i] !== '') {\n            result.push(arr[i]);\n          }\n        }\n\n        return result;\n      })();\n      return pathArray.join(delimiter);\n    },\n    resolve: function(base, relativeStr) {\n      if (!Array.isArray(relativeStr)) {\n        relativeStr = relativeStr.split(delimiter);\n      }\n\n      var baseArray = base.split(delimiter);\n      var result = [];\n\n      var completeArr = baseArray.concat(relativeStr);\n\n      // Last identifier should not be ..\n      var lastElement = completeArr.length - 1;\n      \n      if ((completeArr[lastElement] === '..') || (completeArr[lastElement] === '.')) {\n        completeArr[lastElement] = '';\n      }\n\n      for (var i = 0, j = completeArr.length; i < j; i++) {\n        if (completeArr[i] != null && completeArr[i] !== '') {\n          if (completeArr[i] === '.') {\n            continue;\n          }\n\n          if (completeArr[i + 1] === '..') {\n            completeArr[i] = '';\n            completeArr[i + 1] = '';\n\n            continue;\n          }\n\n          result.push(completeArr[i]);\n        }\n      }\n\n      return Path.join(result);\n    },\n    dotToPath: function(str) {\n      if (!str) {\n        return;\n      }\n      \n      if (~str.indexOf('.')) {\n        return Path.join(str.split('.'));        \n      } else {\n        return str;\n      }\n      \n    }\n  };\n\n  return Path;\n});\n","define('random', function() {\n  'use strict';\n  \n  return function(max, min) {\n    if (max == null) {\n      max = 1.0;\n    }\n    \n    if (min == null) {\n      min = 0.0;\n    }\n    \n    return Math.floor(Math.random() * (max - min)) + min;\n  };\n});","(function(root) {\r\n  'use strict';\r\n  \r\n  define('root', function() {\r\n    return root;\r\n  });\r\n})(this);","define('lyria/game', ['eventmap', 'mixedice', 'fullscreen', 'jquery', 'gameboard/loop', './viewport', './scene/director', './preloader', './world', './checkpoints'], function(EventMap, mixedice, fullscreen, $, Loop, Viewport, Director, Preloader, World, Checkpoints) {'use strict';\r\n\r\n  /**\r\n   * @module lyria/game\r\n   * @requires eventmap\r\n   * @requires mixedice\r\n   * @requires fullscreen\r\n   * @requires jquery\r\n   * @requires gameboard/loop\r\n   * @requires lyria/viewport\r\n   * @requires lyria/scene/director\r\n   * @requires lyria/preloader\r\n   * @requires lyria/world\r\n   * @requires lyria/checkpoints\r\n   */\r\n\r\n  return (function() {\r\n\r\n    /**\r\n     * Game class which has a viewport, scene director and preloader by\r\n     * default.\r\n     * \r\n     * @constructor\r\n     * @alias module:lyria/game\r\n     */\r\n    var Game = function(options) {\r\n      var self = this;\r\n\r\n      options = $.extend({\r\n        startLoop: true\r\n      }, options);\r\n      \r\n      mixedice([this, Game.prototype], new EventMap());\r\n\r\n      /**\r\n       * @property viewport\r\n       * @type {Viewport}\r\n       */\r\n      // Set up a viewport\r\n      this.viewport = new Viewport();\r\n      this.viewport.parent = this;\r\n\r\n      /**\r\n       * @property director\r\n       * @type {Director}\r\n       */\r\n      // Add a scene director\r\n      this.director = new Director(this.viewport);\r\n      this.director.parent = this;\r\n\r\n      /**\r\n       * @property preloader\r\n       * @type {Preloader}\r\n       */\r\n      // Add a preloader\r\n      this.preloader = new Preloader();\r\n      this.preloader.parent = this;\r\n\r\n      // Bind the scene director to the preloader reference\r\n      this.preloader.sceneDirector = this.director;\r\n      \r\n      this.paused = false;\r\n      \r\n      // Mute\r\n      this.mute = false;\r\n      \r\n      // World reference\r\n      this.world = new World();\r\n      this.world.parent = this;\r\n      \r\n      // Checkpoints\r\n      this.checkpoints = new Checkpoints();\r\n\r\n      // Add an update task to the loop with updates the scene director on each\r\n      // frame\r\n      Game.Loop.on('update', function(dt) {\r\n        self.director.trigger('update', dt);\r\n      });\r\n      \r\n      // Run game loop (if it should start by default)\r\n      // In most cases, you'll need the loop (animation/physics/etc.)\r\n      // In a pure event-based game - like a turn-based-strategy game -\r\n      // you might want turn startLoop off\r\n      if (options.startLoop) {\r\n        Game.Loop.run();\r\n      }\r\n      \r\n      this.on('pause', function() {\r\n        self.paused = true;\r\n      });\r\n      \r\n      this.on('resume', function() {\r\n        self.paused = false;\r\n      });\r\n      \r\n      this.on('fullscreen', function() {\r\n        var viewportElement = self.viewport.$element[0];\r\n        \r\n        if (!viewportElement) {\r\n          return;\r\n        }\r\n        \r\n        if (fullscreen.isFullscreen(viewportElement)) {\r\n          fullscreen.cancel(viewportElement);\r\n        } else {\r\n          fullscreen.request(viewportElement);\r\n        }\r\n      });\r\n      \r\n      $(document).ready(function() {\r\n        if (self.pause) {\r\n          $(window).blur(function() {\r\n            self.pause();\r\n          });          \r\n        }\r\n        \r\n        if (self.resume) {\r\n          $(window).focus(function() {\r\n            self.resume();\r\n          });          \r\n        }\r\n      });\r\n    };\r\n    \r\n    /**\r\n     * @param {String} name\r\n     * @param {Object} data\r\n     */\r\n    Game.prototype.addScene = function(name, data) {\r\n      var self = this;\r\n      \r\n      if (!name) {\r\n        return this;\r\n      }\r\n      \r\n      if (Array.isArray(name)) {\r\n        for (var i = 0, j = name.length; i < j; i++) {\r\n          (function(item) {\r\n            if (typeof item === 'object') {\r\n              self.addScene(item.name, item.data);\r\n            } else {\r\n              self.addScene(item);\r\n            }\r\n          })(name[i]);\r\n        }\r\n      }\r\n      \r\n      this.preloader.taskAsync(function(done) {\r\n        self.director.add(name, data, done);\r\n      });\r\n      \r\n      return this;\r\n    };\r\n\r\n    /**\r\n     * @param {String} name\r\n     */\r\n    Game.prototype.showScene = function(name) {\r\n      this.director.show(name);\r\n    };\r\n    \r\n    /**\r\n     * @property Loop\r\n     * @static\r\n     * @type {Loop}\r\n     */\r\n    // Store the reference to the Lyria Loop at the Game object\r\n    Game.Loop = Loop;\r\n\r\n    return Game;\r\n\r\n  })();\r\n\r\n}); ","define('lyria/gameobject', ['mixedice', 'eventmap', './component', './log'], function(mixedice, EventMap, Component, Log) {\r\n  'use strict';\r\n  \r\n  /**\r\n   * @module lyria/gameobject\r\n   * @requires mixedice\r\n   * @requires eventmap\r\n   * @requires lyria/component\r\n   * @requires lyria/log\r\n   */\r\n  \r\n  return (function() {\r\n    \r\n    /**\r\n     * @class\r\n     * @alias module:lyria/gameobject\r\n     * \r\n     */\r\n    var GameObject = function() {\r\n      mixedice([this, GameObject.prototype], new EventMap());\r\n      \r\n      var self = this;\r\n      \r\n      this.components = {};\r\n      this.className = 'gameobject';\r\n      \r\n      this.template = {};\r\n      this.template.source = '<div id=\"{{id}}\" class=\"{{className}}\"></div>';\r\n      \r\n      this.on('update', function(dt) {\r\n        if (_.isEmpty(self.components)) {\r\n          return;\r\n        }\r\n        \r\n        _.each(self.components, function(key, value) {\r\n          value.trigger('update', dt);\r\n        });\r\n      });\r\n    };\r\n    \r\n    /**\r\n     * Refreshes the game object\r\n     *\r\n     * @param {Object} val\r\n     */\r\n    GameObject.prototype.refresh = function(val) {\r\n      if (val == null && this.template) {\r\n        val = this.template.data;\r\n      }\r\n\r\n      if (this.template && this.template.source) {\r\n        this.content = this.template.source(val);\r\n      }\r\n\r\n      this.trigger('refresh');\r\n    };\r\n    \r\n    /**\r\n     * \r\n     * @param {module:lyria/component} component\r\n     */\r\n    GameObject.prototype.add = function(component) {\r\n      if (component instanceof Component) {\r\n        this.components[component.name] = component;\r\n      }\r\n    };\r\n    \r\n    /**\r\n     * \r\n     * @param {Function} functionBody\r\n     */\r\n    GameObject.prototype.execute = function(functionBody) {\r\n      functionBody.apply(this, this);\r\n    };\r\n    \r\n    /**\r\n     * Logs from the game object itself\r\n     * \r\n     * @param {String} text\r\n     */\r\n    GameObject.prototype.log = function(text) {\r\n      Log.i('GameObject: ' + text);\r\n    };\r\n    \r\n    return GameObject;\r\n    \r\n  })();\r\n  \r\n});","define('lyria/language', ['detectr', 'eventmap', './mixin/language'], function(detectr, EventMap, langMixin) {\n  'use strict';\n  \n  /**\n   * @module lyria/language \n   * @requires detectr\n   * @requires eventmap\n   * @requires lyria/mixin/language\n   */\n  \n  var langEvents = new EventMap();\n  \n  // Fallback language\n  var langObject = {\n    defaultLanguage: 'en',\n    on: langEvents.on,\n    off: langEvents.off\n  };\n\n  var langProp = detectr.Browser.language() || langObject.defaultLanguage;\n\n  langMixin('value', 'change')(langObject, langProp, langEvents);\n\n  return langObject;\n});","define('lyria/layer', ['mixedice', './gameobject'], function(mixedice, GameObject) {\r\n  'use strict';\r\n  /**\r\n   * @module lyria/layer\r\n   * @requires mixedice\r\n   * @requires lyria/gameobject\r\n   */\r\n\r\n  return (function() {\r\n\r\n    /**\r\n     * @class\r\n     * @alias module:lyria/layer\r\n     * \r\n     * @augments module:lyria/eventmap \r\n     */\r\n    var Layer = function() {\r\n      mixedice(this.prototype, new GameObject());\r\n    };\r\n\r\n    return Layer;\r\n\r\n  })();\r\n}); ","define('lyria/localization/group', ['../localization'], function(Localization) {\n  'use strict';\n  \n  var LocalizationGroup = (function() {\n    var LocalizationGroup = function(groups) {\n      for (var key in groups) {\n        var value = groups[key];\n        \n        this[key] = new Localization(value);\n      }\n    };\n    \n    return LocalizationGroup;\n  })();\n  \n  return LocalizationGroup;\n  \n});\n","define('lyria/localization', ['./language', './template/string', './mixin/language'], function(Language, templateString, langMixin) {\n  'use strict';\n\n  var Localization = (function() {\n    var Localization = function(data) {\n      if (data == null) {\n        data = {};\n      }\n      \n      this.data = data;\n\n      var langValue = Language.value;\n\n      langMixin('language', 'change')(this, langValue, this);\n    };\n\n    /**\n     * Gets all localizable elements from a localization \n     */\n    Localization.elements = function(localeData, localeLang, fallbackLang) {\n      if (fallbackLang == null) {\n        fallbackLang = 'en';\n      }\n      \n      return function(name, parameter) {\n        if (!localeData || Object.keys(localeData).length === 0) {\n          return '[[No language data found]]';          \n        }\n        \n        if (!localeData[localeLang] || Object.keys(localeData[localeLang]).length === 0) {\n          localeLang = fallbackLang;\n        }\n        \n        if (localeData[localeLang]) {\n          \n          if (localeData[localeLang][name] == null) {\n            return '[[Missing localization for ' + name + ']]';\n          }\n\n          if ( typeof localeData[localeLang][name] === 'string') {\n            return templateString.process(localeData[localeLang][name], parameter);\n          } else {\n            return {\n              plural: function(n) {\n                if (localeData[localeLang][name][n]) {\n                  return templateString.process(localeData[localeLang][name][n], parameter);\n                } else {\n                  return templateString.process(localeData[localeLang][name]['n'], parameter);\n                }\n              }\n            };\n          }\n        } else {\n          return '[[No language definition found for ' + localeLang + ']]';\n        }\n      };\n    };\n\n    /**\n     * Check if name does exist in the localization\n     * \n     * @param {String} name\n     */\n    Localization.prototype.exists = function(name) {\n      return !!(this.data && this.data[this.language] && this.data[this.language][name]);\n    };\n\n    /**\n     * Shorthand function to use translation \n     */\n    Localization.prototype.t = function() {\n      return Localization.elements(this.data, this.language).apply(this, arguments);\n    };\n\n    return Localization;\n  })();\n\n  return Localization;\n});","define('lyria/log', ['root', 'gameboard/log'], function(root, Log) {\r\n  'use strict';\r\n  \r\n  // Map shorthand functions to Log.i\r\n  root.log = root.out = Log.i;\r\n  \r\n  return Log;\r\n});","/**\n * Mixin language property into objects\n * TODO: Refactor this to use mixedice library\n */\n\ndefine('lyria/mixin/language', function() {\n  'use strict';\n  \n  /**\n   * @module lyria/mixin/language\n   */\n  \n  /**\n   * @mixin\n   * \n   * @param {String} propertyName\n   * @param {Function} propertyTrigger\n   */\n  return function(propertyName, propertyTrigger) {\n    if (propertyName == null) {\n      propertyName = 'language';\n    }\n    \n    if (propertyTrigger == null) {\n      propertyTrigger = 'language:change';\n    }\n    \n    return function(attachedObject, value, eventMap) {\n  \n      Object.defineProperty(attachedObject, propertyName, {\n        get: function() {\n          return value;\n        },\n        set: function(val) {\n          value = val;\n          eventMap.trigger(propertyTrigger, value);\n        },\n        configurable: true,\n        enumarable: true\n      });\n  \n    };\n  };\n}); ","define('lyria/mixin/templatable', function() {\n  'use strict';\n  \n  return function() {\n    \n  };\n});\n","define('lyria/prefab', ['./scene'], function(Scene) {\r\n\t'use strict';\r\n\t\r\n\t/**\r\n\t * @module lyria/prefab\r\n\t * @requires lyria/scene \r\n\t */\r\n\r\n  // TODO: Allow own Prefab.requireAlways similar to Scene.requireAlways\r\n\r\n\t//Lyria.Prefab\r\n\treturn Scene;\r\n  \r\n});","define('lyria/prefab/manager', ['jqueryify', 'jquery', 'root'], function($ify, $, root) {\r\n  'use strict';\r\n  \r\n  /**\r\n   * @exports lyria/prefab/manager\r\n   * @requires jqueryify\r\n   * @requires jquery\r\n   * @requires root \r\n   */\r\n  \r\n  var PrefabManager = {};\r\n\r\n  PrefabManager.prefabs = {};\r\n  PrefabManager.viewport = null;\r\n  PrefabManager.className = 'prefab';\r\n  PrefabManager.parent = null;\r\n\r\n  var createElement = function(type) {\r\n    return function(options, data) {\r\n      var name = options.name;\r\n      // Allow target to be an alias for parent\r\n      var parent = options.parent || options.target;\r\n      \r\n      // TODO: Streamline the way of passing data to scenes and prefabs\r\n      data = data || options.data || {};\r\n      \r\n      if (options.wrap == null) {\r\n        options.wrap = true;\r\n      }\r\n      \r\n      // TODO: Wrap typically wraps the content - this is default behavior right now\r\n      var wrap = options.wrap;\r\n      \r\n      if (parent == null) {\r\n        parent = ((PrefabManager.viewport) ? PrefabManager.viewport.$element :\r\n        void 0) || 'body';\r\n      }\r\n      \r\n      var prefab = null;\r\n      \r\n      var elementId = name;\r\n      \r\n      if (elementId) {\r\n        if (elementId.indexOf('.') >= 0) {\r\n          elementId = elementId.replace(/\\./g, '--');\r\n        }\r\n        \r\n        if (elementId.indexOf('/') >= 0) {\r\n          elementId = elementId.replace(/\\//g, '--');\r\n        }\r\n        \r\n        if (elementId.indexOf('#') >= 0) {\r\n          elementId = elementId.replace(/#/g, '--');\r\n        }\r\n      }\r\n      \r\n      var prefabId = PrefabManager.className + '-' + elementId + '-' + Date.now();\r\n      \r\n      data.id = prefabId;\r\n      \r\n      if (!PrefabManager.prefabs[name]) {\r\n        throw new Error('No valid prefab called ' + name + ' found.');\r\n      } else {\r\n        prefab = PrefabManager.prefabs[name](data);\r\n      }\r\n\r\n      var $parent = $ify(parent);\r\n\r\n      if ($parent) {\r\n        if ($('#' + prefab.name).length === 0) {\r\n          $parent[type]($(root.document.createElement('div')).attr('id', prefabId).attr('class', PrefabManager.className));\r\n        }\r\n        \r\n        prefab.parent = PrefabManager;\r\n\r\n        if (!prefab.isAsync) {\r\n          prefab.trigger('added', function() {\r\n            prefab.trigger('active');\r\n          });\r\n        }\r\n      }\r\n      \r\n      return prefab;\r\n    };\r\n  };\r\n\r\n  PrefabManager.append = function() {\r\n    return createElement('append').apply(this, arguments);\r\n  };\r\n\r\n  PrefabManager.prepend = function() {\r\n    return createElement('prepend').apply(this, arguments);\r\n  };\r\n  \r\n  PrefabManager.insert = function() {\r\n    return createElement('html').apply(this, arguments);\r\n  };\r\n\r\n  return PrefabManager;\r\n});\r\n","define('lyria/preloader', ['root', 'mixedice', 'jquery', './resource', './log', 'eventmap'], function(root, mixedice, $, Resource, Log, EventMap) {'use strict';\n  /**\n   * @module lyria/preloader\n   * @requires root\n   * @requires mixedice\n   * @requires jquery\n   * @requires lyria/resource\n   * @requires lyria/log\n   * @requires eventmap\n   */\n\n  /**\n   * Provides a preloader to load assets before they are needed\n   *\n   * @class\n   * @alias module:lyria/preloader\n   * @augments module:eventmap\n   */\n  var Preloader = (function() {\n\n    /**\n     * @constructor\n     *\n     * @param {Object} assetObject\n     */\n    var Preloader = function(assetObject) {\n      mixedice([this, Preloader.prototype], new EventMap());\n\n      /**\n       * @property assets\n       * @type {Array}\n       */\n      if (assetObject != null) {\n        this.assets = assetObject;\n      } else {\n        this.assets = {};\n      }\n\n      /**\n       * @property maxAssets\n       * @type {Number}\n       * @default 0\n       */\n      this.maxAssets = 0;\n\n      /**\n       * @property assetsLoaded\n       * @type {Number}\n       * @default 0\n       */\n      this.assetsLoaded = 0;\n\n      /**\n       * @property percentLoaded\n       * @type {Number}\n       * @default 0\n       */\n      this.percentLoaded = 0;\n\n      /**\n       * @property taskList\n       * @type {Array}\n       */\n      this.taskList = [];\n    };\n\n    /**\n     * Adds a custom task to the preloader\n     *\n     * @param {Function} taskFn\n     */\n    Preloader.prototype.task = function(taskFn) {\n      if ( typeof taskFn === 'function') {\n        this.taskList.push({\n          task: taskFn,\n          async: false\n        });\n      }\n    };\n\n    /**\n     * Adds a custom asynchronous task to the preloader\n     *\n     * @param {Function} taskFn\n     */\n    Preloader.prototype.taskAsync = function(taskFn) {\n      if ( typeof taskFn === 'function') {\n        this.taskList.push({\n          task: taskFn,\n          async: true\n        });\n      }\n    };\n\n    /**\n     * Starts the preloader and loads all assets asynchronously. Triggers\n     * events when necessary.\n     */\n    Preloader.prototype.start = function() {\n      // Check if it's valid\n      if (this.assets == null) {\n        throw new Error('Assets should not be null. Pass at least an empty object.');\n      }\n\n      this.trigger('start');\n\n      var totalSize = 0;\n\n      // Trigger complete event if there is nothing to load\n      if (Object.keys(this.assets).length > 0) {\n        totalSize = this.assets.totalSize;\n      }\n\n      var currentProgress = 0;\n\n      var hasLoadingScene = this.sceneDirector != null && this.loadingScene != null;\n\n      if (hasLoadingScene) {\n        this.sceneDirector.show(this.loadingScene);\n      }\n\n      var self = this;\n      \n      var loadCustomTasks = function(done) {\n        var maxTasks = self.taskList.length;\n        var currentTasks = 0;\n\n        var checkIfComplete = function() {\n          if (currentTasks === maxTasks) {\n            done();\n          }\n        };\n        \n        var doneFn = function() {\n          currentTasks++;\n          checkIfComplete();\n        };\n\n        if (self.taskList.length === 0) {\n          done();\n        } else {\n          for (var i = 0, j = self.taskList.length; i < j; i++) {\n            (function(item) {\n              if (item.async) {\n                item.task.call(this, doneFn);\n              } else {\n                item.task();\n                doneFn();\n              }\n            })(self.taskList[i]);\n          }\n        }\n\n      };\n\n      var loadingProgress = function() {\n\n        var percentLoaded = 1;\n\n        if (currentProgress !== totalSize) {\n          percentLoaded = currentProgress / totalSize;\n        }\n\n        self.trigger('progress', percentLoaded);\n\n        if (hasLoadingScene) {\n          self.sceneDirector.currentScene.trigger('progress', percentLoaded, currentProgress, totalSize);\n        }\n\n        if (currentProgress >= totalSize) {\n          loadCustomTasks(function() {\n            if (hasLoadingScene) {\n              self.sceneDirector.currentScene.trigger('complete');\n            }\n  \n            self.trigger('complete');\n          });\n        }\n      };\n      \n      var loadSuccess = function(iterator) {\n        return function() {\n          currentProgress += iterator.size;\n          self.assetsLoaded++;\n\n          loadingProgress();\n        };\n      };\n      \n      var loadError = function(iterator) {\n        return function(err) {\n          Log.e('Error while loading ' + iterator.name + ': ' + err);\n        };\n      };\n      var supportedTypes = {\n        'mp3' : 'audio/mpeg',\n        'wav' : 'audio/wav',\n        'ogg' : 'audio/ogg'\n      };\n      if (Object.keys(this.assets).length > 0) {\n        // Go through all assets and preload them\n        $.each(this.assets, function(key, value) {\n\n          if (value.files == null || !Array.isArray(value.files) || value.files.length === 0) {\n            return true;\n          }\n          \n          self.maxAssets += value.files.length;\n\n          for (var i = 0, j = value.files.length; i < j; i++) {\n            (function(iterator) {\n              // Handle images here\n              if (iterator.type.indexOf('image') === 0) {\n                // TODO: Reflect: Does it make sense to put the cached images into an object?\n                var img = new root.Image();\n                img.onload = loadSuccess(iterator);\n                img.onerror = loadError(iterator);\n\n                img.src = iterator.name;\n              } else {\n                // Handle audio here\n                if (iterator.type.indexOf('audio') === 0) {\n                  // TODO: Save preloaded files in the AudioManager\n                  var audioType = iterator.name.split('.').pop();\n                  var audio = new root.Audio();\n                  if (supportedTypes[audioType] && audio.canPlayType(supportedTypes[audioType])) {\n                    audio.addEventListener('canplaythrough', loadSuccess(iterator));\n                    audio.onerror = loadError(iterator);\n                    \n                    audio.src = iterator.name;\n                    audio.load();\n                  } else {\n                    Log.w('Skipped unsupported audio file ('+supportedTypes[audioType]+') ' + iterator.name);\n                    loadSuccess(iterator)();\n                  }\n                } else {\n                  $.ajax({\n                    url: iterator.name,\n                    dataType: 'text'\n                  }).always(loadSuccess(iterator)).error(loadError(iterator));\n                }\n              }\n\n            })(value.files[i]);\n          }\n        });\n      } else {\n        loadingProgress();\n      }\n\n    };\n\n    return Preloader;\n\n  })();\n\n  return Preloader;\n});\n","define('lyria/resource', ['path'], function(Path) {\r\n  'use strict';\r\n\r\n  /**\r\n   * @exports lyria/resource\r\n   * @requires path \r\n   */\r\n  \r\n  var Resource = {\r\n    /**\r\n     * @member {Object} module:lyria/resource.path\r\n     */\r\n    path: {\r\n      /**\r\n       * @member {String} module:lyria/resource.path.assets=assets\r\n       * @member {String} module:lyria/resource.path.audio=audio\r\n       * @member {String} module:lyria/resource.path.data=data\r\n       * @member {String} module:lyria/resource.path.image=images\r\n       * @member {String} module:lyria/resource.path.scene=scenes\r\n       * @member {String} module:lyria/resource.path.video=video\r\n       * @member {String} module:lyria/resource.path.prefab=prefabs\r\n       */\r\n      assets: 'assets',\r\n      audio: 'audio',\r\n      data: 'data',\r\n      image: 'images',\r\n      scene: 'scenes',\r\n      video: 'video',\r\n      prefab: 'prefabs'\r\n    },\r\n  \r\n    /**\r\n     * Returns the relative filename to an asset by filename and type\r\n     * \r\n     * @param {String} filename The filename\r\n     * @param {String} type The type of the asset\r\n     * @returns {String}\r\n     * \r\n     * @example\r\n     * Resource.name('mything.json'); // => \"assets/mything.json\"\r\n     * \r\n     * @example\r\n     * Resource.name('myimage.png', 'image'); // => \"assets/images/myimage.png\"\r\n     */\r\n    name: function(filename, type) {\r\n      if (!filename) {\r\n        return;\r\n      }\r\n  \r\n      var assetPath = Resource.path['assets'];\r\n      var typePath = (Resource.path[type]) ? (Resource.path[type]) : type;\r\n      \r\n      return Path.resolve(assetPath, [Path.dotToPath(typePath), filename]);\r\n    }\r\n    \r\n  };\r\n  \r\n  return Resource;\r\n}); ","define('lyria/scene/director', ['require'], function(require) {'use strict';\r\n\r\n  var root = require('root');\r\n  var mixedice = require('mixedice');\r\n  var $ = require('jquery');\r\n  var EventMap = require('eventmap');\r\n  var Scene = require('../scene');\r\n  var Viewport = require('../viewport');\r\n\r\n  /**\r\n   * @module lyria/scene/director\r\n   * @requires root\r\n   * @requires mixedice\r\n   * @requires jquery\r\n   * @requires eventmap\r\n   * @requires lyria/scene\r\n   * @requires lyria/viewport \r\n   */\r\n\r\n  /**\r\n   * The scene director is the manager for all scenes\r\n   *\r\n   */\r\n  return (function() {\r\n\r\n    /**\r\n     * The scene director constructor\r\n     * Attaches a scene director to a container, the parent is optional\r\n     *\r\n     * @class\r\n     * @alias module:lyria/scene/director\r\n     * @augments EventMap\r\n     * \r\n     * @fires module:lyria/scene/director#render\r\n     * @fires module:lyria/scene/director#update\r\n     *\r\n     * @param {Viewport} [container]\r\n     * @param {jQuery|String} [parent]\r\n     */\r\n    function SceneDirector(container, parent) {\r\n      mixedice([this, SceneDirector.prototype], new EventMap());\r\n\r\n      if ( container instanceof Viewport) {\r\n        this.viewport = container;\r\n      } else {\r\n        this.viewport = new Viewport(container, {\r\n          parent: parent\r\n        });\r\n      }\r\n\r\n      /**\r\n       * All scenes\r\n       *\r\n       * @member {Object} sceneList\r\n       * @memberof module:lyria/scene/director\r\n       */\r\n      this.sceneList = {};\r\n\r\n      /**\r\n       * @member {String} className\r\n       * @memberof module:lyria/scene/director\r\n       */\r\n      this.className = 'scene';\r\n\r\n      /**\r\n       * The current scene\r\n       *\r\n       * @member {Scene} currentScene\r\n       * @memberof module:lyria/scene/director\r\n       */\r\n      this.currentScene = null;\r\n\r\n      /**\r\n       * The default scene\r\n       *\r\n       * @member {String} defaultScene\r\n       * @memberof module:lyria/scene/director\r\n       */\r\n      this.defaultScene = null;\r\n\r\n      /**\r\n       * Event for rendering all scenes\r\n       *  \r\n       * @event module:lyria/scene/director#render\r\n       */\r\n      \r\n      /**\r\n       * Event for updating all scenes \r\n       *\r\n       * @event module:lyria/scene/director#update\r\n       * @property {Number} dt Delta time\r\n       */\r\n      \r\n      this.on('render', function() {\r\n        if (this.currentScene) {\r\n          this.currentScene.trigger('render');\r\n        }\r\n      });\r\n\r\n      this.on('update', function(dt) {\r\n        if (this.currentScene) {\r\n          this.currentScene.trigger('update', dt);\r\n        }\r\n      });\r\n    }\r\n\r\n    /**\r\n     * Adds a scene to the scene director\r\n     *\r\n     * @param {Object} scene\r\n     * @param {Object} data\r\n     */\r\n    SceneDirector.prototype.add = function(scene, data, done) {\r\n\r\n      // Shorthand to add all scenes to the scene director\r\n      if (scene === '*' && this.scenes) {\r\n        scene = Object.keys(this.scenes);\r\n      }\r\n\r\n      // Allow array as scenes\r\n      if (Array.isArray(scene)) {\r\n        for (var i = 0, j = scene.length; i < j; i++) {\r\n          this.add(scene[i], data, done);\r\n        }\r\n        return;\r\n      }\r\n\r\n      // Handle string - Check in scene list\r\n      if (this.scenes && Object.keys(this.scenes).length > 0 && this.scenes[scene]) {\r\n        scene = this.scenes[scene](data);\r\n      } else {\r\n        // Scene object\r\n        if ( scene instanceof Scene) {\r\n          // Add to scenes if it's an actual scene\r\n          if (data) {\r\n            scene.data = data;\r\n          }\r\n          this.scenes[scene.name] = scene;\r\n        } else {\r\n          // Function\r\n          if ( typeof scene === 'function') {\r\n            var sceneObj = scene(data);\r\n\r\n            this.scenes[sceneObj.name] = sceneObj;\r\n          } else {\r\n            // Well, if none of these - There is only one choice\r\n            throw new Error('No valid scene found.');\r\n          }\r\n        }\r\n      }\r\n\r\n      // Set scene parent\r\n      scene.parent = this;\r\n\r\n      // Update reference to the game itself\r\n      if (this.parent != null) {\r\n        scene.game = this.parent;\r\n      }\r\n\r\n      // Add first scene as a default scene\r\n      if (Object.keys(this.sceneList).length === 0) {\r\n        this.defaultScene = scene.name;\r\n      }\r\n\r\n      // Set scene in sceneList\r\n      this.sceneList[scene.name] = scene;\r\n\r\n      if (this.viewport.$element) {\r\n        if ($('#' + scene.name).length === 0) {\r\n          this.viewport.$element.prepend($(root.document.createElement('div')).attr('id', scene.name).attr('class', this.className));\r\n        }\r\n      }\r\n\r\n      scene.trigger('added', done);\r\n\r\n      return this;\r\n    };\r\n\r\n    /**\r\n     * Shows a specified scene\r\n     *\r\n     * @param {String} scene name of scene\r\n     * @param {Object} options\r\n     * @param {Function} callback\r\n     */\r\n    SceneDirector.prototype.show = function(sceneName, options, callback) {\r\n      if (!sceneName) {\r\n        return;\r\n      }\r\n\r\n      // More than one scene visible at the same time\r\n      if ($('.' + this.className + ':visible')) {\r\n        $('.' + this.className).hide();\r\n      }\r\n\r\n      if (this.currentScene) {\r\n        if (this.currentScene.transition && this.currentScene.length) {\r\n          $('#' + this.currentScene).hide(this.currentScene.transition.length, function() {\r\n            $('.' + this.className).hide();\r\n          });\r\n        } else {\r\n          $('.' + this.className).hide();\r\n        }\r\n\r\n        this.currentScene.trigger('deactivate', options);\r\n      }\r\n\r\n      var self = this;\r\n\r\n      self.currentScene = this.sceneList[sceneName];\r\n      \r\n      if (self.currentScene == null) {\r\n        throw new Error('Scene ' + sceneName + ' not found.');\r\n      }\r\n\r\n      if (self.currentScene.transition && self.currentScene.transition.length) {\r\n        $('#' + sceneName).show(self.currentScene.transition.length);\r\n      } else {\r\n        $('#' + sceneName).show();\r\n      }\r\n      this.trigger('scene:change', sceneName);\r\n      \r\n      self.currentScene.trigger('active', options);\r\n\r\n      if (callback) {\r\n        callback(sceneName);\r\n      }\r\n    };\r\n\r\n    /**\r\n     * Refreshes a scene\r\n     *\r\n     * @param {String} scene\r\n     */\r\n    SceneDirector.prototype.refresh = function(scene) {\r\n      var sceneObj = (scene) ? this.sceneList[scene] : this.currentScene;\r\n\r\n      // Re-compile scene template\r\n      sceneObj.refresh();\r\n    };\r\n\r\n    return SceneDirector;\r\n\r\n  })();\r\n}); ","define('lyria/scene', ['require'], function(require) {'use strict';\r\n\r\n  var $ = require('jquery');\r\n  var mixedice = require('mixedice');\r\n  var nextTick = require('nexttick');\r\n  var Component = require('./component');\r\n  var GameObject = require('./gameobject');\r\n  var Log = require('./log');\r\n  var Localization = require('./localization');\r\n\r\n  /**\r\n   * @module lyria/scene\r\n   * @requires jquery\r\n   * @requires mixedice\r\n   * @requires nexttick\r\n   * @requires lyria/component\r\n   * @requires lyria/gameobject\r\n   * @requires lyria/log\r\n   * @requires lyria/localization\r\n   */\r\n\r\n  var createNamespace = function(obj, chain, value) {\r\n    if (Array.isArray(chain)) {\r\n      for (var c = 0, cl = chain.length; c < cl; c++) {\r\n        createNamespace(obj, chain[c], value);\r\n      }\r\n      return;\r\n    }\r\n    \r\n    var chainArr = chain.split('.');\r\n\r\n    for (var i = 0, j = chainArr.length; i < j; i++) {\r\n      (function(item, lastElem) {\r\n        if (lastElem) {\r\n          obj[item] = value;\r\n        } else {\r\n          obj[item] = obj[item] || {};\r\n        }\r\n\r\n        obj = obj[item];\r\n      })(chainArr[i], i === j - 1);\r\n    }\r\n  };\r\n\r\n  var Scene = (function() {\r\n\r\n    /**\r\n     * Scene constructor\r\n     *\r\n     * @class\r\n     * @alias module:lyria/scene\r\n     */\r\n    \r\n    // TODO: Having options as the last parameter is kinda unintuitive\r\n    var Scene = function(sceneName, sceneDeps, sceneFunction, options) {\r\n      if (!sceneName) {\r\n        throw new Error('A scene needs to have a name');\r\n      }\r\n\r\n      if ( typeof sceneDeps === 'function') {\r\n        sceneFunction = sceneDeps;\r\n        sceneDeps = {};\r\n      }\r\n      \r\n      options = options || {};\r\n\r\n      // Mixin event map into Scene\r\n      // Sender: \"scene:#{sceneName}\"\r\n      mixedice([this, Scene.prototype], new Component(sceneName));\r\n\r\n      // We need a reference to the scene not being this\r\n      var self = this;\r\n\r\n      // Set type\r\n      this.type = 'Scene';\r\n      \r\n      // Data\r\n      this.data = options.data || {};\r\n\r\n      // Default values\r\n      this.localization = new Localization();\r\n\r\n      // Default event value\r\n      this.defaultEvent = null;\r\n      \r\n      // DOMEvents object\r\n      this.DOMEvents = {};\r\n\r\n      // Template values\r\n      this.template = {};\r\n      this.template.source = null;\r\n      this.template.helpers = {};\r\n      this.template.partials = {};\r\n      \r\n      // Collect all template values\r\n      this.template.data = {};\r\n\r\n      // Children object\r\n      // TODO: This is not needed, if a scene is actually a component - maaagic!\r\n      this.children = this.children || {};\r\n      this.children.gameObjects = {};\r\n      this.children.prefabs = {};\r\n      \r\n      // Set Id\r\n      this.id = this.data.id || self.name;\r\n\r\n      // Expose function for template values\r\n      this.expose = function(obj) {\r\n        if (!obj || $.isEmptyObject(obj)) {\r\n          return;\r\n        }\r\n\r\n        self.template.data = $.extend(true, self.template.data, obj);\r\n      };\r\n\r\n      // Getter to have a safe way to the element of a scene\r\n      Object.defineProperty(self, '$element', {\r\n        get: function() {\r\n          return $('#' + self.id);\r\n        }\r\n      });\r\n\r\n      // Synchronizes events and scene view\r\n      self.on('synchronize', function(callback) {\r\n        self.refresh();\r\n\r\n        if (self.DOMEvents && !$.isEmptyObject(self.DOMEvents)) {\r\n          self.DOMEvents.delegate = '#' + self.id;\r\n        }\r\n\r\n        // Your typical stock-of-the-mill update function\r\n        self.on('update', function(dt) {\r\n          $.each(self.children, function(childKey, childValue) {\r\n            if (!$.isEmptyObject(childValue)) {\r\n              $.each(childValue, function(key, value) {\r\n                value.trigger('update', dt);\r\n              });\r\n            }\r\n          });\r\n        });\r\n\r\n        // Bind events\r\n        if (self.DOMEvents && !$.isEmptyObject(self.DOMEvents)) {\r\n          $.each(self.DOMEvents, function(key, value) {\r\n            if (( typeof value === 'object') && (key !== 'delegate')) {\r\n              $(self.DOMEvents.delegate).on(value, key, {\r\n                scene: self\r\n              });\r\n            }\r\n          });\r\n        }\r\n\r\n        // Data binding\r\n        // TODO: Find a better way than using Object.watch\r\n        if (self.template.data && !$.isEmptyObject(self.template.data)) {\r\n          self.$element.find('[data-bind]').each(function() {\r\n            var $dataElem = $(this);\r\n\r\n            var prop = $dataElem.data('bind');\r\n\r\n            self.template.data.watch(prop, function(id, oldval, newval) {\r\n              if (oldval !== newval) {\r\n                $dataElem.html(newval);\r\n              }\r\n\r\n              return newval;\r\n            });\r\n          });\r\n        }\r\n        \r\n        if (callback) {\r\n          callback();          \r\n        }\r\n      });\r\n\r\n      var createScene = function(modules, callback) {\r\n        var sceneDone = function(err, success) {\r\n          if (err) {\r\n            console.error('Error while executing scene ' + self.name + ': ' + err);\r\n            if (err.stack) {\r\n              console.error(err.stack);\r\n            }\r\n            return;\r\n          }\r\n\r\n          self.trigger('synchronize', callback);\r\n        };\r\n\r\n        var async = false;\r\n\r\n        var context = self;\r\n        context.async = function() {\r\n          async = true;\r\n\r\n          return function() {\r\n            nextTick(function() {\r\n              sceneDone();\r\n            });\r\n          };\r\n        };\r\n\r\n        if (!self.hasOwnProperty('isAsync')) {\r\n          Object.defineProperty(self, 'isAsync', {\r\n            get: function() {\r\n              return async;\r\n            }\r\n          });\r\n        }\r\n\r\n        context.modules = modules;\r\n\r\n        try {\r\n          var success = sceneFunction.apply(context, [context, modules]);\r\n\r\n          if (!async) {\r\n            sceneDone(null, success);\r\n          }\r\n        } catch (e) {\r\n          sceneDone(e);\r\n        }\r\n      };\r\n\r\n      // Call scene\r\n      var reqModules = Object.keys(Scene.requireAlways) || [];\r\n\r\n      self.on('added', function(callback) {\r\n        require(reqModules, function() {\r\n          var importedModules = {};\r\n  \r\n          for (var i = 0, j = arguments.length; i < j; i++) {\r\n            (function(dep) {\r\n              createNamespace(importedModules, Scene.requireAlways[reqModules[i]], dep);\r\n            })(arguments[i]);\r\n          }\r\n  \r\n          sceneDeps = sceneDeps || {};\r\n          var reqSceneModules = Object.keys(sceneDeps) || [];\r\n  \r\n          if (reqSceneModules.length) {\r\n            require(reqSceneModules, function() {\r\n  \r\n              for (var k = 0, l = arguments.length; k < l; k++) {\r\n                (function(sceneDep) {\r\n                  createNamespace(importedModules, sceneDeps[reqSceneModules[j]], sceneDep);\r\n                })(arguments[j]);\r\n              }\r\n  \r\n              createScene(importedModules, callback);\r\n            });\r\n          } else {\r\n            createScene(importedModules, callback);\r\n          }\r\n  \r\n        });\r\n      });\r\n      \r\n    };\r\n\r\n    /**\r\n     * Adds a gameobject to the scene\r\n     *\r\n     * @param {Object} child\r\n     */\r\n    Scene.prototype.add = function(child) {\r\n      var self = this;\r\n\r\n      if ( child instanceof GameObject) {\r\n        this.children.gameObjects[child.name] = child;\r\n\r\n        this.template.data.gameobject = (function() {\r\n          var array = [];\r\n\r\n          $.each(self.children.gameObjects, function(key, value) {\r\n            array.push(value);\r\n          });\r\n\r\n          return array;\r\n        })();\r\n\r\n        this.trigger('add');\r\n\r\n        return true;\r\n      }\r\n\r\n      if ( child instanceof GameObject) {\r\n        this.children.prefabs[child.name] = child;\r\n\r\n        this.template.data.gameobject = (function() {\r\n          var array = [];\r\n\r\n          $.each(self.children.gameObjects, function(key, value) {\r\n            array.push(value);\r\n          });\r\n\r\n          return array;\r\n        })();\r\n\r\n        this.trigger('add');\r\n\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n    };\r\n\r\n    /**\r\n     * Refreshes the scene (Re-renders the template)\r\n     *\r\n     * @param {Object} val\r\n     */\r\n    Scene.prototype.refresh = function(val) {\r\n      if (val == null && this.template) {\r\n        val = this.template.data;\r\n      }\r\n\r\n      // Add default helpers\r\n      this.template.helpers['translate'] = Localization.elements(this.localization.data, this.localization.language);\r\n\r\n      if (this.template && this.template.source) {\r\n        this.content = this.template.source(val, {\r\n          partials: this.template.partials,\r\n          helpers: this.template.helpers\r\n        });\r\n      }\r\n\r\n      if (this.$element.length > 0) {\r\n        this.$element.html(this.content);\r\n      }\r\n\r\n      this.trigger('refresh');\r\n    };\r\n\r\n    /**\r\n     * Sets an event to the event object (DOM events)\r\n     *\r\n     * @param {String} selector\r\n     * @param {String} eventName\r\n     * @param {Function} eventFunction\r\n     */\r\n    Scene.prototype.bindEvent = function(selector, eventName, eventFunction) {\r\n      if (selector == null) {\r\n        return;\r\n      }\r\n      \r\n      var defaultEvent = this.defaultEvent || Scene.defaultEvent;\r\n\r\n      this.DOMEvents[selector] = this.DOMEvents[selector] || {};\r\n\r\n      if ( typeof eventName === 'function') {\r\n        this.DOMEvents[selector][defaultEvent] = eventName;\r\n      } else {\r\n        if (typeof eventName === 'string') {\r\n          this.DOMEvents[selector][eventName] = eventFunction;          \r\n        } else {\r\n          throw new Error('If you meant to bind more than one event, please use Scene#bindEvents');\r\n        }\r\n      }\r\n    };\r\n\r\n    /**\r\n     * Binds a lot of events instead of a single one\r\n     * \r\n     * @param {Object} eventObject\r\n     * @see bindEvent\r\n     */\r\n    Scene.prototype.bindEvents = function(eventObject) {\r\n      if (eventObject == null) {\r\n        return;\r\n      }\r\n      \r\n      for (var key in eventObject) {\r\n        if (Object.hasOwnProperty.call(eventObject, key)) {\r\n          this.DOMEvents[key] = eventObject[key];\r\n        }\r\n      }\r\n    };\r\n\r\n    /*\r\n     * Unbinds a previously bound event\r\n     *\r\n     * @param {String} selector\r\n     * @param {String} eventName\r\n     * @param {Function} eventFunction\r\n     */\r\n    Scene.prototype.unbindEvent = function(selector, eventName) {\r\n      if (selector == null) {\r\n        return;\r\n      }\r\n\r\n      if (eventName == null) {\r\n        delete this.DOMEvents[selector];\r\n      } else {\r\n        delete this.DOMEvents[selector][eventName];\r\n      }\r\n    };\r\n    \r\n    /**\r\n     * Unbinds a lot of events\r\n     * \r\n     * @param [Object] eventObject\r\n     */\r\n    Scene.prototype.unbindEvents = function(eventObject) {\r\n      if (eventObject == null || eventObject === '*') {\r\n        this.DOMEvents = {};\r\n        return;\r\n      }\r\n      \r\n      if (Array.isArray(eventObject)) {\r\n        for (var i = 0, j = eventObject.length; i < j; i++) {\r\n          if (this.DOMEvents[eventObject[i]]) {\r\n            delete this.DOMEvents[eventObject[i]];\r\n          }\r\n        }\r\n      } else {\r\n        for (var key in eventObject) {\r\n          if (Object.hasOwnProperty.call(eventObject, key)) {\r\n            var value = eventObject[key];\r\n            \r\n            if (Array.isArray(value)) {\r\n              for (var k = 0, l = value.length; k < l; k++) {\r\n                delete this.DOMEvents[key][value[k]];\r\n              }\r\n            } else {\r\n              delete this.DOMEvents[key][value];\r\n            }\r\n          }\r\n        }\r\n      }\r\n    };\r\n    \r\n    /**\r\n     * Binds an DOM event to the specified data-behavior selector\r\n     *\r\n     * @param {String} behaviorName\r\n     * @param {String} eventName\r\n     * @param {Function} eventFunction\r\n     */\r\n    Scene.prototype.behavior = function(behaviorName, eventName, eventFunction) {\r\n      this.bindEvent('[data-behavior~=' + behaviorName +  ']', eventName, eventFunction);\r\n    };\r\n\r\n    /**\r\n     * Gets localized value\r\n     *\r\n     * @param {Object} lang\r\n     */\r\n    Scene.prototype.t = function() {\r\n      if (this.localization && this.localization.t) {\r\n        return this.localization.t.apply(this.localization, arguments);\r\n      } else {\r\n        return;\r\n      }\r\n    };\r\n    \r\n    Scene.defaultEvent = 'click';\r\n\r\n    Scene.requireAlways = {\r\n      // Third-party modules\r\n      'jquery': ['jQuery', '$'],\r\n      \r\n      // Lyria modules\r\n      'lyria/achievement': 'Lyria.Achievement',\r\n      'lyria/achievement/manager': 'Lyria.AchievementManager',\r\n      'lyria/animation': 'Lyria.Animation',\r\n      'lyria/audio': 'Lyria.Audio',\r\n      'lyria/checkpoints': 'Lyria.Checkpoints',\r\n      'lyria/component': 'Lyria.Component',\r\n      'lyria/gameobject': 'Lyria.GameObject',\r\n      'lyria/log': 'Lyria.Log',\r\n      'lyria/prefab/manager': 'Lyria.PrefabManager',\r\n      'lyria/resource': 'Lyria.Resource',\r\n      'lyria/tween': 'Lyria.Tween'\r\n    };\r\n\r\n    return Scene;\r\n\r\n  })();\r\n\r\n  return Scene;\r\n\r\n});\r\n","define('lyria/serialize', ['jquery'], function($) {\n  'use strict';\n  \n  /**\n   * @exports lyria/serialize\n   * @requires jquery \n   */\n  \n  /**\n   *\n   * @param {Object} anyObject\n   *\n   * @returns {String}\n   */\n  var serialize = function(anyObject) {\n    if ((anyObject === undefined) || ( anyObject instanceof $)) {\n      return;\n    }\n    \n    if (typeof anyObject === 'function') {\n      return anyObject.toString();\n    }\n    \n    return JSON.stringify(anyObject, function(key, value) {\n      if (value instanceof $) {\n        return null;\n      }\n      \n      if (typeof value === 'function') {\n        value = value.toString();\n      }\n      \n      return value;\n    });\n  };\n\n  return serialize;\n});\n","define('lyria/sprite', function() {\n  'use strict';\n  \n  var Sprite = (function() {\n    \n    var Sprite = function() {\n      \n    };\n    \n    return Sprite;\n    \n  })();\n  \n  return Sprite;\n});\n","define('lyria/sprite/manager', ['jquery', 'mixedice', '../component', '../sprite/renderer'], function($, mixedice, Component, Renderer) {\n  'use strict';\n  \n  var SpriteManager = (function() {\n    \n    var SpriteManager = function() {\n      var type = 'SpriteManager';\n      \n      mixedice([this, SpriteManager.prototype], new Component(type));\n      this.type = type;\n    };\n    \n    return SpriteManager;\n    \n  })();\n  \n  return SpriteManager;\n  \n});\n","define('lyria/sprite/renderer', function() {\n  \n});\n","define('lyria/template/connector', ['./methods'], function(templateMethods) {\r\n  'use strict';\r\n  \r\n  /**\r\n   * @module lyria/template/connector\r\n   * @requires lyria/template/methods \r\n   */\r\n  \r\n  var noop = function() {\r\n  };\r\n\r\n  return (function() {\r\n\r\n    /**\r\n     * @class\r\n     * @alias module:lyria/template/connector\r\n     */\r\n    var TemplateConnector = function(functionRefs) {\r\n      if ( typeof functionRefs === 'object') {\r\n        var key, value;\r\n\r\n        for (key in functionRefs) {\r\n          value = functionRefs[key];\r\n\r\n          if ( typeof value === 'function') {\r\n            this[key] = value;\r\n          }\r\n        }\r\n\r\n      }\r\n    };\r\n\r\n    for (var i = 0, j = templateMethods.length; i < j; i++) {\r\n      (function(iterator) {\r\n        TemplateConnector.prototype[iterator] = noop;\r\n      })(templateMethods[i]);\r\n    }\r\n\r\n    return TemplateConnector;\r\n\r\n  })();\r\n}); ","define('lyria/template/engine', ['hbs', './connector', './methods'], function(Handlebars, TemplateConnector, templateMethods) {\r\n  'use strict';\r\n\r\n  /**\r\n   * @module lyria/template/engine\r\n   * @requires hbs\r\n   * @requires lyria/template/connector\r\n   * @requires lyria/template/methods\r\n   */\r\n\r\n  var noop = function() {\r\n  };\r\n\r\n  /**\r\n   * @class\r\n   * @alias module:lyria/template/engine\r\n   *\r\n   * @param {Object} templateConnector\r\n   */\r\n  var TemplateEngine = function(templateConnector) {\r\n    if ( templateConnector instanceof TemplateConnector) {\r\n      for (var i = 0, j = templateMethods.length; i < j; i++) {\r\n        (function(iterator) {\r\n          if ((templateConnector[iterator] != null) && ( typeof templateConnector[iterator] === 'function')) {\r\n            TemplateEngine[iterator] = templateConnector[iterator];\r\n          } else {\r\n            TemplateEngine[iterator] = noop;\r\n          }\r\n        })(templateMethods[i]);\r\n      }\r\n    }\r\n  };\r\n\r\n  if (Handlebars) {\r\n    var handlebarsConnector = new TemplateConnector({\r\n      compile: function() {\r\n        return Handlebars.template.apply(this, arguments);\r\n      },\r\n      globalHelpers: function() {\r\n        return Handlebars.helpers;\r\n      }\r\n    });\r\n\r\n    new TemplateEngine(handlebarsConnector);\r\n  }\r\n  \r\n  return TemplateEngine;\r\n\r\n});\r\n","define('lyria/template/methods', function() {\r\n  'use strict';\r\n  \r\n  return ['compile'];\r\n});\r\n","define('lyria/template/string', ['objectify'], function(objectify) {\n  'use strict';\n  \n  var templateString = {\n    key: {\n      start: '\\\\{{',\n      end: '\\\\}}'\n    },\n    process: function(value, parameter) {\n      if (value == null) {\n        return;\n      }\n      \n      if (parameter == null) {\n        return value;\n      }\n      \n      // Array or object\n      if ( typeof parameter === 'object') {\n        var templateObject = objectify(parameter);\n        \n        var keys = Object.keys(templateObject);\n        \n        for (var i = 0, j = keys.length; i < j; i++) {\n          (function(num, item) {\n            value = value.replace(new RegExp(templateString.key.start + num + templateString.key.end, 'g'), item);\n          })(keys[i], templateObject[keys[i]]);\n        }\n        \n      }\n\n      return value;\n    }\n  };\n\n  return templateString;\n});\n","define('lyria/tween', ['eventmap', 'mixedice', 'options', 'jqueryify'], function (EventMap, mixedice, options, $fy) {\n  'use strict';\n\n  /**\n   * @module lyria/tween\n   * @requires eventmap\n   * @requires mixedice\n   * @requires options\n   * @requires jqueryify\n   */\n\n  var Tween = (function () {\n\n    /**\n     * @class\n     * @alias module:lyria/tween\n     *\n     * @param {Object} opts\n     * @param {String} opts.property - The property that gets animated\n     * @param {String|jQuery} opts.target - The target of the tween\n     * @param {String} opts.easing - The easing of the tween, for example linear\n     * @param {Number} opts.duration - How long the tween is being animated\n     * @param {Number} opts.delay - Delays the tween at the beginning\n     */\n    var Tween = function (opts) {\n      opts = options(opts, {\n        elem: null,\n        effects: [\n          {\n            property: null,\n            target: null,\n            easing: Tween.defaults.easing,\n            duration: Tween.defaults.duration,\n            delay: Tween.defaults.delay\n          }\n        ]\n      });\n\n      this.$elem = $fy(opts.elem);\n      this.effects = opts.effects;\n\n      this.hwAccelerated = true;\n\n      mixedice([this, Tween.prototype], new EventMap());\n\n      var self = this;\n\n      this.on('start', function () {\n        if (self.$elem) {\n          return;\n        }\n\n        var effects = [];\n        var properties = {};\n\n        for (var i = 0, j = self.effects.length; i < j; i++) {\n          (function (item) {\n            if (item.property == null || item.target == null) {\n              return;\n            }\n\n            item.duration = item.duration || Tween.defaults.duration;\n            item.easing = item.easing || Tween.defaults.easing;\n            item.delay = item.delay || Tween.defaults.delay;\n\n            effects.push([item.property, item.duration, item.easing, item.delay].join(' '));\n            properties[item.property] = item.target;\n          })(self.effects[i]);\n        }\n\n        properties['transition'] = effects.join(', ');\n        self.$elem.css(properties);\n\n        $(document).one('transitionend', function (e) {\n          console.log(e.target);\n        });\n      });\n    };\n\n    /**\n     * @member module:lyria/tween.defaults\n     */\n    Tween.defaults = {\n      easing: 'linear',\n      duration: '300ms',\n      delay: '0ms'\n    };\n\n    return Tween;\n  })();\n\n  return Tween;\n\n});\n","define('lyria/video', function() {\r\n  'use strict';\r\n  \r\n  /**\r\n   * @module lyria/video \r\n   */\r\n\r\n  var Video =  (function() {\r\n    /**\r\n     * @class\r\n     * @alias module:lyria/video \r\n     */\r\n    var Video = function() {\r\n\r\n    };\r\n\r\n    Video.prototype.loadFromFile = function() {\r\n      \r\n    };\r\n    \r\n    Video.prototype.play = function() {\r\n      \r\n    };\r\n    \r\n    Video.prototype.pause = function() {\r\n      \r\n    };\r\n    \r\n    Video.prototype.stop = function() {\r\n      \r\n    };\r\n\r\n    return Video;\r\n  })();\r\n  \r\n  return Video;\r\n  \r\n});\r\n","define('lyria/viewport', ['root', 'jquery', 'mixedice', 'eventmap'], function(root, $, mixedice, EventMap) {'use strict';\r\n\r\n  /**\r\n   * @module lyria/viewport\r\n   * @requires root\r\n   * @requires jquery\r\n   * @requires mixedice\r\n   * @requires eventmap \r\n   */\r\n\r\n  return (function() {\r\n\r\n    /**\r\n     * @class Viewport\r\n     * @constructor\r\n     */\r\n    function Viewport(container, options) {\r\n      var defaultOptions = {\r\n        parent: null,\r\n        trigger: {\r\n          element: window,\r\n          event: 'resize'\r\n        },\r\n        scaleMode: 'scaleToFit'\r\n      };\r\n\r\n      options = $.extend(defaultOptions, options);\r\n      \r\n      mixedice([this, Viewport.prototype], new EventMap());\r\n\r\n      this.scale = {};\r\n      this.scale.mode = options.scaleMode;\r\n      this.scale.x = 1.0;\r\n      this.scale.y = 1.0;\r\n\r\n      // Defaults container to the string 'viewport'\r\n      if (container == null) {\r\n        container = 'viewport';\r\n      }\r\n      \r\n      Object.defineProperty(this, '$element', {\r\n        get: function() {\r\n          return $('#' + container);\r\n        }\r\n      });\r\n\r\n      /**\r\n       * The viewport element (jQuery object)\r\n       *\r\n       * @property $element\r\n       * @type {jQuery}\r\n       */\r\n      if (this.$element.length === 0) {\r\n        var createdElement = $(root.document.createElement('div')).attr('id', container).attr('class', 'viewport');\r\n        // TODO: Set properties to set origin to center\r\n\r\n        if (options.parent) {\r\n          $(options.parent).prepend(createdElement);\r\n        } else {\r\n          $('body').prepend(createdElement);\r\n        }\r\n      }\r\n\r\n      Object.defineProperty(this, 'width', {\r\n        get: function() {\r\n          return this.$element.outerWidth();\r\n        }\r\n      });\r\n\r\n      Object.defineProperty(this, 'height', {\r\n        get: function() {\r\n          return this.$element.outerHeight();\r\n        }\r\n      });\r\n\r\n      var self = this;\r\n\r\n      this.on('scale', function() {\r\n        \r\n        // TODO: Reset scaling to 1.0\r\n        \r\n        var scaleElement = function(scaleX, scaleY) {\r\n          if (scaleY == null) {\r\n            scaleY = scaleX;\r\n          }\r\n          \r\n          var scaleExp = 'scale(' + scaleX + ', ' + scaleY + ')';\r\n          self.$element.css('transform', scaleExp);\r\n          \r\n          if ((self.scale.x !== scaleX) || (self.scale.y !== scaleY)) {\r\n            self.scale.x = scaleX;\r\n            self.scale.y = scaleY;\r\n            \r\n            self.trigger('scale:change', self.scale.x, self.scale.y);            \r\n          }\r\n        };\r\n\r\n        var scaleHeightToFit = function(doNotSetTransform) {\r\n          var scaleFactor = 0;\r\n          \r\n          if (self.height > $(options.trigger.element).innerHeight()) {\r\n            scaleFactor = $(options.trigger.element).innerHeight() / self.height;\r\n\r\n            if (doNotSetTransform) {\r\n              return scaleFactor;\r\n            } else {\r\n              scaleElement(scaleFactor);\r\n              return scaleFactor;\r\n            }\r\n          }\r\n          \r\n          return 1.0;\r\n        };\r\n\r\n        var scaleWidthToFit = function(doNotSetTransform) {\r\n          var scaleFactor = 0;\r\n          \r\n          if (self.width > $(options.trigger.element).innerWidth()) {\r\n            scaleFactor = $(options.trigger.element).innerWidth() / self.width;\r\n            \r\n            if (doNotSetTransform) {\r\n              return scaleFactor;\r\n            } else {\r\n              scaleElement(scaleFactor);\r\n              return scaleFactor;\r\n            }\r\n          }\r\n          \r\n          return 1.0;\r\n        };\r\n\r\n        switch (self.scale.mode) {\r\n          case 'stretch':\r\n            break;\r\n          case 'cover':\r\n            break;\r\n          case 'scaleToFit':\r\n            var scaleX = 1;\r\n            var scaleY = 1;\r\n          \r\n            if ($(options.trigger.element).innerHeight() < self.height) {\r\n              scaleY = scaleHeightToFit(true);\r\n            }\r\n            \r\n            if ($(options.trigger.element).innerWidth() < self.width) { \r\n              scaleX = scaleWidthToFit(true);                \r\n            }\r\n            \r\n            scaleElement(Math.min(scaleX, scaleY));\r\n            break;\r\n          case 'scaleHeightToFit':\r\n            scaleHeightToFit();\r\n            break;\r\n          case 'scaleWidthToFit':\r\n            scaleWidthToFit();\r\n            break;\r\n          default:\r\n            break;\r\n        }\r\n      });\r\n\r\n      $(options.trigger.element).on(options.trigger.event, function() {\r\n        self.trigger('scale');\r\n      });\r\n      \r\n      // Call scale event\r\n      self.trigger('scale');\r\n    }\r\n    \r\n    // TODO: Reflect if it should be fitWidthToAspectRatio and fitHeightToAspectRatio\r\n    // TODO: Reflect if this should be done when resizing (scale event)\r\n    Viewport.prototype.fitToAspectRatio = function(dimension) {\r\n      var windowRatio = $(window).width() / $(window).height();\r\n      \r\n      switch (dimension) {\r\n        case 'width':\r\n          var newWidth = this.height * windowRatio;\r\n          this.$element.width(newWidth);\r\n          this.$element.css('margin-left', (newWidth / (-2)) + 'px');\r\n          break;\r\n        case 'height':\r\n          var newHeight = this.width / windowRatio;\r\n          this.$element.height(newHeight);\r\n          this.$element.css('margin-top', (newHeight / (-2)) + 'px');        \r\n          break;\r\n      }\r\n    };\r\n\r\n    return Viewport;\r\n\r\n  })();\r\n});\r\n","define('lyria/world/data', function() {\n  'use strict';\n  \n  var WorldData = (function() {\n    \n    var WorldData = function(parent) {\n      \n    };\n    \n    return WorldData;\n    \n  })();\n  \n  return WorldData;\n  \n});\n","define('lyria/world', ['mixedice', 'eventmap', 'lyria/world/data'], function(mixedice, EventMap, WorldData) {'use strict';\n\n  var World = (function() {\n\n    var World = function() {\n      mixedice([this, World.prototype], new EventMap());\n      \n      this.events = new EventMap();\n      this.data = new WorldData(this);\n\n      this.register({\n        name: 'state',\n        value: ''\n      });\n    };\n\n    World.prototype.register = function(options) {\n      var name = options.name;\n      var value = options.value;\n      var isConstant = options.constant;\n\n      var self = this;\n\n      var getter = function(val) {\n        self.trigger('value', name, value);\n        self.trigger(name + ':value', value);\n\n        return val;\n      };\n\n      var setter = function(val) {\n        if (value !== val) {\n          value = val;\n\n          self.trigger('change', name, value);\n          self.trigger(name + ':change', value);\n        }\n      };\n\n      var propDef = {\n        get: getter\n      };\n\n      if (isConstant) {\n        propDef['set'] = setter;\n      }\n\n      Object.defineProperty(this, name, propDef);\n    };\n    \n    World.prototype.initialize = function(obj) {\n      \n    };\n    \n    World.prototype.reset = function() {\n      \n    };\n\n    World.prototype.serialize = function() {\n      return JSON.stringify(this);\n    };\n\n    World.prototype.deserialize = function() {\n\n    };\n\n    return World;\n\n  })();\n  \n  return World;\n\n});\n","define('lyria/template/list', {\n  'achievement-list': {\n    \"1\": function(depth0, helpers, partials, data) {\n      var stack1, buffer = \"\";\n      stack1 = this.invokePartial(partials.achievement, '    ', 'achievement', depth0, undefined, helpers, partials, data);\n      if (stack1 != null) {\n        buffer += stack1;\n      }\n      return buffer;\n    },\n    \"compiler\": [6, \">= 2.0.0-beta.1\"],\n    \"main\": function(depth0, helpers, partials, data) {\n      var stack1, buffer = \"<div class=\\\"achievement-list\\\">\\n\";\n      stack1 = helpers.each.call(depth0, (depth0 != null ? depth0.achievement : depth0), {\n        \"name\": \"each\",\n        \"hash\": {},\n        \"fn\": this.program(1, data),\n        \"inverse\": this.noop,\n        \"data\": data\n      });\n      if (stack1 != null) {\n        buffer += stack1;\n      }\n      return buffer + \"</div>\";\n    },\n    \"usePartial\": true,\n    \"useData\": true\n  },\n  'achievement': {\n    \"1\": function(depth0, helpers, partials, data) {\n      return \"offscreen\";\n    },\n    \"3\": function(depth0, helpers, partials, data) {\n      var helper, functionType = \"function\",\n        helperMissing = helpers.helperMissing,\n        escapeExpression = this.escapeExpression;\n      return \"  <div class=\\\"progress-status\\\">\\n    <span class=\\\"current\\\">\" + escapeExpression(((helper = (helper = helpers.current || (depth0 != null ? depth0.current : depth0)) != null ? helper : helperMissing), (typeof helper === functionType ? helper.call(depth0, {\n        \"name\": \"current\",\n        \"hash\": {},\n        \"data\": data\n      }) : helper))) + \"</span>\\n    <span class=\\\"separator\\\">\" + escapeExpression(((helper = (helper = helpers.separator || (depth0 != null ? depth0.separator : depth0)) != null ? helper : helperMissing), (typeof helper === functionType ? helper.call(depth0, {\n        \"name\": \"separator\",\n        \"hash\": {},\n        \"data\": data\n      }) : helper))) + \"</span>\\n    <span class=\\\"max\\\">\" + escapeExpression(((helper = (helper = helpers.max || (depth0 != null ? depth0.max : depth0)) != null ? helper : helperMissing), (typeof helper === functionType ? helper.call(depth0, {\n        \"name\": \"max\",\n        \"hash\": {},\n        \"data\": data\n      }) : helper))) + \"</span>\\n  </div>\\n\";\n    },\n    \"compiler\": [6, \">= 2.0.0-beta.1\"],\n    \"main\": function(depth0, helpers, partials, data) {\n      var stack1, helper, functionType = \"function\",\n        helperMissing = helpers.helperMissing,\n        escapeExpression = this.escapeExpression,\n        buffer = \"<div id=\\\"\" + escapeExpression(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : helperMissing), (typeof helper === functionType ? helper.call(depth0, {\n          \"name\": \"id\",\n          \"hash\": {},\n          \"data\": data\n        }) : helper))) + \"\\\" class=\\\"achievement \";\n      stack1 = helpers['if'].call(depth0, (depth0 != null ? depth0.offscreen : depth0), {\n        \"name\": \"if\",\n        \"hash\": {},\n        \"fn\": this.program(1, data),\n        \"inverse\": this.noop,\n        \"data\": data\n      });\n      if (stack1 != null) {\n        buffer += stack1;\n      }\n      buffer += \"\\\">\\n  <div class=\\\"title\\\">\" + escapeExpression(((helper = (helper = helpers.title || (depth0 != null ? depth0.title : depth0)) != null ? helper : helperMissing), (typeof helper === functionType ? helper.call(depth0, {\n        \"name\": \"title\",\n        \"hash\": {},\n        \"data\": data\n      }) : helper))) + \"</div>\\n  <div class=\\\"icon \" + escapeExpression(((helper = (helper = helpers.className || (depth0 != null ? depth0.className : depth0)) != null ? helper : helperMissing), (typeof helper === functionType ? helper.call(depth0, {\n        \"name\": \"className\",\n        \"hash\": {},\n        \"data\": data\n      }) : helper))) + \"\\\"></div>\\n  <div class=\\\"description\\\">\" + escapeExpression(((helper = (helper = helpers.description || (depth0 != null ? depth0.description : depth0)) != null ? helper : helperMissing), (typeof helper === functionType ? helper.call(depth0, {\n        \"name\": \"description\",\n        \"hash\": {},\n        \"data\": data\n      }) : helper))) + \"</div>\\n\";\n      stack1 = helpers['if'].call(depth0, (depth0 != null ? depth0.progressable : depth0), {\n        \"name\": \"if\",\n        \"hash\": {},\n        \"fn\": this.program(3, data),\n        \"inverse\": this.noop,\n        \"data\": data\n      });\n      if (stack1 != null) {\n        buffer += stack1;\n      }\n      return buffer + \"</div>\";\n    },\n    \"useData\": true\n  },\n  'scene': {\n    \"1\": function(depth0, helpers, partials, data) {\n      var helper, functionType = \"function\",\n        helperMissing = helpers.helperMissing,\n        escapeExpression = this.escapeExpression;\n      return \"  <canvas id=\\\"\" + escapeExpression(((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : helperMissing), (typeof helper === functionType ? helper.call(depth0, {\n        \"name\": \"name\",\n        \"hash\": {},\n        \"data\": data\n      }) : helper))) + \"\\\" class=\\\"\" + escapeExpression(((helper = (helper = helpers.type || (depth0 != null ? depth0.type : depth0)) != null ? helper : helperMissing), (typeof helper === functionType ? helper.call(depth0, {\n        \"name\": \"type\",\n        \"hash\": {},\n        \"data\": data\n      }) : helper))) + \"\\\"></canvas>\\n\";\n    },\n    \"3\": function(depth0, helpers, partials, data) {\n      var helper, functionType = \"function\",\n        helperMissing = helpers.helperMissing,\n        escapeExpression = this.escapeExpression;\n      return \"  <div id=\\\"\" + escapeExpression(((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : helperMissing), (typeof helper === functionType ? helper.call(depth0, {\n        \"name\": \"name\",\n        \"hash\": {},\n        \"data\": data\n      }) : helper))) + \"\\\" class=\\\"\" + escapeExpression(((helper = (helper = helpers.type || (depth0 != null ? depth0.type : depth0)) != null ? helper : helperMissing), (typeof helper === functionType ? helper.call(depth0, {\n        \"name\": \"type\",\n        \"hash\": {},\n        \"data\": data\n      }) : helper))) + \"\\\"></div>\\n\";\n    },\n    \"compiler\": [6, \">= 2.0.0-beta.1\"],\n    \"main\": function(depth0, helpers, partials, data) {\n      var stack1;\n      stack1 = helpers['if'].call(depth0, (depth0 != null ? depth0.canvas : depth0), {\n        \"name\": \"if\",\n        \"hash\": {},\n        \"fn\": this.program(1, data),\n        \"inverse\": this.program(3, data),\n        \"data\": data\n      });\n      if (stack1 != null) {\n        return stack1;\n      } else {\n        return '';\n      }\n    },\n    \"useData\": true\n  }\n});"]}