/*! lyria - v0.2.0 - 02-05-2013 */
define("lyria/achievements",["root","jquery"],function(e,t){"use strict";var n=function(){var n,r={},o=function(t){n=t,e.localStorage&&e.localStorage[n]&&(r=JSON.parse(e.localStorage[n]))},i=function(e,t,n){r[e]={active:!1},t!==void 0&&(r[e].description=t),n!==void 0&&(r[e].icon=n)},a=function(){return Object.keys(r).length},c=function(){var e=0;for(var t in r)r[t].active&&e++;return e},s=function(){var e="";for(var t in r)e+=r[t].active?'<div class="ach_box unlocked"><span class="ach_unlocked">'+t+'</span><br /><span class="ach_details">'+r[t].description+"</span></div><br /><br />":'<div class="ach_box locked"><span class="ach_locked">'+t+'</span><br /><span class="ach_details">'+r[t].description+"</span></div><br /><br />";return e},u=function(o){"undefined"===r[o]&&i(o),r[o].active||(r[o].icon||t(".status.achievement").css("background-image","url("+r[o].icon+")"),t(".achievement .text").html(o),t(".status.achievement").css({opacity:0}).animate({opacity:1,bottom:"8px"},750).delay(2500).animate({opacity:0,bottom:"-80px"},750),r[o].active=!0),e.localStorage&&(e.localStorage[n]=JSON.stringify(r))};return{initialize:o,getCount:a,getUnlockedCount:c,list:s,register:i,show:u}}();return n}),define("lyria/resource",function(){var e={path:{assets:"assets",audio:"audio",data:"data",image:"images",scene:"scenes",video:"video",prefab:"prefabs"},name:function(t,n){if(t){var r=e.path.assets,o="";return o=e.path[n]?e.path[n]:n,o?[r,o.split(".").join("/"),t].join("/"):[r,t].join("/")}}};return e}),define("lyria/audio",["root","jquery"],function(e,t){"use strict";var n=function(){var e=!1,n={},r=function(e,r){if(r&&"object"==typeof r){var o=document.createElement("audio");n[e]=r,t(o).attr("id",e).attr("preload","auto").append('<source src="'+r.filepath+'" />'),t("body").append(o),r.play&&this.play(e)}},o=function(e){e&&"string"==typeof fileObj&&(t("#"+e).remove(),window.log("Lyria.audio.removeAudioElement: "+e+" removed"))},i=function(r){n[r],t("#"+r).one("ended",{audioManager:this},function(e){window.chrome?t(this).load():t(this).currentTime=0;var n=t(this).attr("id"),r=e.data.audioManager.getSound(n);r.playAfter&&t("#"+r.playAfter).length>0&&e.data.audioManager.play(r.playAfter),r.loop&&e.data.audioManager.play(t(this).attr("id"))}),t("#"+r)[0].play(),e&&(t("#"+r)[0].volume=0)},a=function(e){return n[e]},c=function(e){t("#"+e).length>0?t("#"+e)[0].pause():window.log("error","Lyria.Audio.pause: cant finde element "+e+" to pause")},s=function(e){t("#"+e).length>0&&t("#"+e)[0]&&t("#"+e)[0].pause&&(t("#"+e)[0].pause(),t("#"+e)[0].currentTime=0)},u=function(e){return t("#"+e)[0].duration},l=function(e,n){return t("#"+e).length>0?"number"!=typeof n?t("#"+e)[0].volume:(t("#"+e)[0].volume=n,void 0):0},f=function(e,n){return"number"!=typeof n?t("#"+e)[0].currentTime:(t("#"+e)[0].currentTime=n,void 0)},p=function(e,t){switch(e){case"duration":case"length":return u();case"position":case"pos":if(t===void 0)return f();f(t);break;case"volume":if(t===void 0)return l();l(t)}},d=function(r){e=r;for(var o in n)n.hasOwnProperty(o)&&t("#"+o).length>0&&(t("#"+o)[0].volume=r?0:1)};return{addAudioElement:r,removeAudioElement:o,play:i,getSound:a,pause:c,stop:s,muteSounds:d,getLength:u,volume:l,pos:f,attr:p}};return n}),define("lyria/component",function(){return function(){function e(e){this.name=null!=e?e:this.constructor.name}return e.prototype.register=function(){},e.prototype.unregister=function(){},e.prototype.render=function(){},e.prototype.update=function(){},e}()}),define("lyria/debug",function(){return!0}),define("lyria/constants",function(){return{animSpeed:300}}),define("lyria/language",["detectr"],function(e){var t="en";return e.Browser.language()||t}),function(e){define("root",function(){return e})}(this),define("mixin",function(){var e,t=[].slice;return e=function(){var e,n,r,o,i,a,c;if(o=arguments[0],r=arguments.length>=2?t.call(arguments,1):[],o||r){for(a=0,c=r.length;c>a;a++){n=r[a];for(e in n)i=n[e],Object.hasOwnProperty.call(o,e)||(o[e]=i)}return null}}}),define("requestAnimationFrame",["root"],function(e){for(var t=e.requestAnimationFrame,n=["ms","moz","webkit","o"],r=0;n.length>r&&!window.requestAnimationFrame&&!(t=e[n[r]+"RequestAnimationFrame"]);++r);return t||(t=function(e){window.setTimeout(e,~~(1e3/window.frameRate))}),t}),define("cancelAnimationFrame",["root"],function(e){for(var t=e.cancelAnimationFrame,n=["ms","moz","webkit","o"],r=0;n.length>r&&!window.requestAnimationFrame&&(cancelRequestAnimationFrame=e[n[r]+"CancelRequestAnimationFrame"],!t);++r);t||(t=function(e){clearTimeout(e)})}),define("lyria/entity",function(){return function(){function e(e){this.name=null!=e?e:this.constructor.name,this.components={},t={}}var t;return t={},e.prototype.add=function(e){var n,r,o,i;if(!e)return this;if(r=e.name,n=this.components[r],!n){n=e,"function"==typeof n.register&&n.register();for(o in n)i=n[o],"constructor"!==o&&"function"==typeof i&&(t[o]||(t[o]=[]),t[o].push(i),this[o]||(this[o]=function(e){return function(){var n,r,o,i;for(i=t[e],r=0,o=i.length;o>r;r++)n=i[r],n.apply(this,arguments);return this}}(o)))}return this},e.prototype.remove=function(e){var t;return this.components[e]&&("function"==typeof(t=this.components[e]).unregister&&t.unregister(),delete this.components[e]),this},e.prototype.render=function(){var e,t,n;n=this.components;for(e in n)t=n[e],"function"==typeof t.render&&t.render();return this},e.prototype.update=function(e){var t,n,r;r=this.components;for(t in r)n=r[t],"function"==typeof n.update&&n.update(e);return this},e}()}),define("lyria/eventmap",function(){"use strict";var e=[].slice;return function(){function t(e){this.sender=e,r={},n={}}var n,r;return r={},n={},t.prototype.validEvents=[],t.prototype.on=function(e,t){var n;if(t&&!(this.validEvents.length>0&&-1===validEvents.indexOf(e)))return n={event:t,id:-1,type:"",sender:this.sender},r[e]?r[e].push(n):r[e]=[n],this},t.prototype.off=function(e){return e?(("once"===r[e].type||"repeat"===r[e].type)&&("repeat"===r[e].type&&window.clearInterval(r[e].id),"once"===r[e].type&&window.clearTimeout(r[e].id)),r[e]&&delete r[e],this):void 0},t.prototype.trigger=function(){var t,n,o,i,a,c,s,u,l,f,p;if(o=arguments[0],t=arguments.length>=2?e.call(arguments,1):[],null!=o&&("object"==typeof o?(c=o.name,a=o.interval,s=o.repeat,n=o.context):c=o,r[c])){for(null==a&&(a=0),null==s&&(s=!1),null==n&&(n=this),p=r[c],l=0,f=p.length;f>l;l++)i=p[l],u=function(){return i.event.apply(n,[[i.sender],t].reduce(function(e,t){return e.concat(t)}))},a?s?(i.type="repeat",i.id=window.setInterval(u,a)):(i.type="once",i.id=window.setTimeout(u,a)):(i.type="direct",u.call(this));return this}},t}()}),define("lyria/events",["lyria/eventmap"],function(e){var t=t||new e;return t}),define("lyria/game",["lyria/viewport","lyria/scene/director","lyria/preloader"],function(e,t,n){"use strict";return function(){var r=function(){};return r.prototype.viewport=new e,r.prototype.director=new t(r.prototype.viewport),r.prototype.preloader=new n,r}()}),define("lyria/gameobject",["mixin","lyria/eventmap","lyria/component"],function(e,t){"use strict";return function(){var n=function(){e(n.prototype,new t)};return n.prototype.add=function(){},n.prototype.execute=function(){},n.prototype.log=function(){},n.prototype.update=function(){},n}()}),define("lyria/layer",["lyria/gameobject"],function(e){"use strict";return function(e){var t=function(){};return t.prototype=e.prototype,t}(e)}),define("lyria/localization",["check","jquery","lyria/language"],function(e,t,n){"use strict";return function(){var r=function(r,o){if(r){var i={},a={language:n};o=t.extend(!0,a,o);var c={};e(r,{object:function(e){c=e},string:function(e){t.ajax({url:e,async:!1,dataType:"json",success:function(e){c=e}})}}),i=c[o.language],i||(i=c.en),this.localizeLangObject=i}};return r.prototype.get=function(e,t){return this.localizeLangObject&&this.localizeLangObject[e]?this.localizeLangObject[e]:e||t?e?t?t:e:t:this.localizeLangObject},r}()}),define("lyria/globallocalization",["lyria/localization","lyria/resource"],function(e,t){var n=n||new e(t.name("i18n.json"));return n}),define("lyria/log",["root"],function(e){"use strict";var t=function(){var t={};t.Connector=null,t.Plugins={},t.Plugins.Console={e:function(t){e.console&&e.console.error&&e.console.error(t)},w:function(t){e.console&&e.console.warn&&e.console.warn(t)},i:function(t){e.console&&e.console.info&&e.console.info(t)},d:function(t){e.console&&e.console.log&&e.console.log(t)},v:function(t){e.console&&e.console.log&&e.console.log(t)}},t.Connector=t.Plugins.Console,t.logLevelMap={error:["e"],warn:["w","e"],info:["i","w","e"],debug:["d","i","w","e"],verbose:["v","d","i","w","e"]},t.logLevel="verbose";for(var n=["v","d","i","w","e"],r=0,o=n.length;o>r;r++)(function(e){t[e]=function(){t.logLevelMap[t.logLevel].indexOf(e)>=0&&t.Connector[e].apply(this,arguments)}})(n[r]);return t}();return e.log=e.out=t.i,t}),define("lyria/loop",["root","requestAnimationFrame"],function(e,t){"use strict";return function(){var e={},n=!0,r=function(){var r;(function o(){t(o);var i=Date.now(),a=i-(r||i);r=i,n&&$.each(e,function(e,t){t.paused||t.value(a)})})()},o=function(){n=!1},i=function(){e={}},a=function(t,n){e[t]={paused:!1,value:n}},c=function(t){e[t].paused=!0},s=function(t){e[t].paused=!1},u=function(t){delete e[t]};return{run:r,stop:o,clear:i,addTask:a,removeTask:u,pauseTask:c,resumeTask:s}}()}),define("lyria/prefab",["jquery","lyria/scene"],function(e,t){"use strict";return function(n,r){var o={target:null,template:"prefab.html",data:"prefab.js",path:"prefab",isPrefab:!0};return r=e.extend(!0,o,r),new t(n,r)}}),define("lyria/preloader",["root","check","mixin","jquery","lyria/resource","lyria/log","lyria/eventmap"],function(e,t,n,r,o,i,a){"use strict";var c=function(){var c=function(e){n(c.prototype,new a("Preloader")),this.assets=null!=e?e:[],this.maxAssets=0,this.assetsLoaded=0,this.percentLoaded=0};return c.prototype.start=function(n){function a(){s.percentLoaded=s.assetsLoaded/s.maxAssets,s.trigger("progresschange",s.percentLoaded),n.showLoadingScreen,s.assetsLoaded===s.maxAssets&&(n.showLoadingScreen,s.trigger("complete"))}if(Array.isArray(this.assets)&&0!==this.assets.length){this.trigger("start");var c={showLoadingScreen:!0,loadingScreenClass:"loading-screen",loadingBarClass:"loading-bar"};n=r.extend(!0,c,n);var s=this;this.maxAssets=this.assets.length,r.each(this.assets,function(n,c){t(c,{object:function(){},string:function(t){if(t.indexOf("/"+o.path.image+"/")>=0){var n=new e.Image;n.onload=function(){s.assetsLoaded++,a()},n.onerror=function(){i.e("Error while loading "+t)},n.src=t}else r.ajax({url:t,dataType:"text"}).always(function(){s.assetsLoaded++,a()}).error(function(e){i.e("Error while loading "+t+": "+e)})}})})}},c}();return c}),define("lyria/scene/director",["root","mixin","jquery","lyria/eventmap","lyria/scene","lyria/viewport"],function(e,t,n,r,o,i){"use strict";return function(){function a(e,n){t(a.prototype,new r("SceneDirector")),this.viewport=e instanceof i?e:new i(e,n),this.sceneList={},this.currentScene=null}return a.prototype.sceneClassName="scene",a.prototype.add=function(t){if(!(t instanceof o)){if(!this.precompiledScenes)throw"No valid scene found.";t=this.precompiledScenes[t]}return t.parent=this,this.sceneList[t.name]=t,this.viewport.$container&&0===n("#"+t.name).length&&(this.viewport.$container.prepend(n(e.document.createElement("div")).attr("id",t.name).attr("class",a.prototype.sceneClassName)),t.content&&n("#"+t.name).html(t.content),t.events&&!n.isEmptyObject(t.events)&&n.each(t.events,function(e,r){"object"==typeof r&&"delegate"!==e&&n(t.events.delegate).on(r,e,{scene:t})})),this},a.prototype.show=function(e,t,r){this.trigger("scenechange",e),n("."+a.prototype.sceneClassName+":visible")&&n("."+a.prototype.sceneClassName).hide(),this.currentScene&&(this.currentScene.transition&&this.currentScene.length?n("#"+this.currentScene).hide(this.currentScene.transition.length,function(){n("."+a.prototype.sceneClassName).hide()}):n("."+a.prototype.sceneClassName).hide(),this.currentScene.trigger("deactivate",t));var o=this;n.each(this.sceneList,function(t,i){return t===e?(e.transition&&e.transition.length?n("#"+e).show(e.transition.length):n("#"+e).show(),o.currentScene=i,o.currentScene.trigger("active"),r&&r(e),!1):void 0})},a.prototype.render=function(){this.currentScene.trigger("render")},a.prototype.update=function(e){this.currentScene.trigger("update",e)},a}()}),define("lyria/scene",["jquery","mixin","lyria/eventmap","lyria/gameobject"],function(e,t,n,r){"use strict";return function(){var r=function(o,i,a){if(o){t(r.prototype,new n("scene:"+o));var c=this,s={};this.name=o,this.eventMap=new n,this.localization={},this.expose=function(t){t&&!e.isEmptyObject(t)&&(s=e.extend(!0,s,t))};var u={},l=i.call(this,this);l&&!e.isEmptyObject(l)&&this.expose(l),e.each(u,function(e,t){c[e]||(c[e]=t)}),this.template&&(this.content=this.template(s)),this.events&&(this.events.delegate=a&&a.isPrefab?a.target?a.target:"body":"#"+o)}};return r.prototype.add=function(e){},r}()}),define("lyria/template/connector",["lyria/template/methods"],function(e){var t=function(){};return function(){for(var n=function(e){if("object"==typeof e){var t,n;for(t in e)n=e[t],"function"==typeof n&&(this[t]=n)}},r=0,o=e.length;o>r;r++)(function(e){n.prototype[e]=t})(e[r]);return n}()}),define("lyria/template/engine",["root","lyria/template/connector","lyria/template/methods"],function(e,t,n){var r=function(){},o=function(e){if(e instanceof t)for(var i=0,a=n.length;a>i;i++)(function(t){o[t]=null!=e[t]&&"function"==typeof e[t]?e[t]:r})(n[i])};if(e.Handlebars){var i=new t({compile:function(){return e.Handlebars.template.apply(this,arguments)}});o(i)}return o}),define("lyria/template/methods",function(){return["compile"]}),define("lyria/utils",["jquery"],function(e){var t={};return t.isFile=function(e){var t=e.indexOf(".");if(-1===t)return!1;var n=e.length,r=n-t;return r>1&&5>=r?!0:!1},t.cloneObject=function(t){return e.extend(!0,{},t)},t.serializeObject=function(n){if(!("object"!=typeof n||n instanceof e)){var r="{";for(var o in n)if(n.hasOwnProperty(o)){if(n[o]instanceof e)continue;var i=Object.keys(n),a=i.indexOf(o)===i.length-1?"":",";switch(typeof n[o]){case"object":r+=o+": "+t.serializeObject(n[o])+a+"\n";break;case"string":r+=o+': "'+n[o]+'"'+a+"\n";break;default:r+=o+": "+n[o]+a+"\n"}}return r+="}"}},t}),define("lyria/video",function(){"use strict";return function(){var e=function(){};return e.prototype.loadFromFile=function(){},e.prototype.play=function(){},e.prototype.pause=function(){},e.prototype.stop=function(){},e}()}),define("lyria/viewport",["root"],function(e){"use strict";return function(){function t(t,n){if(null==t&&(t="viewport"),$("#"+t).length>0)this.$container=$("#"+t);else{var r=$(e.document.createElement("div")).attr("id",t);n?$(n).prepend(r):$("body").prepend(r),this.$container=$("#"+t)}}return t.prototype.scale=function(e,t){null!=e&&(null==t&&(t=e),this.$container.css("transform","scale("+e+","+t+")"))},t.prototype.center=function(){},t.prototype.rotate=function(e){null!=e&&this.$container.css("transform","rotate("+e+")")},t}()});